<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>DIC on Posvirus的博客</title>
        <link>https://posvirus.github.io/categories/dic/</link>
        <description>Recent content in DIC on Posvirus的博客</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Chen Wenyao</copyright>
        <lastBuildDate>Mon, 01 Dec 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://posvirus.github.io/categories/dic/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>迭代边界</title>
        <link>https://posvirus.github.io/p/dic-007/</link>
        <pubDate>Mon, 01 Dec 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-007/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-007/cicc.png" alt="Featured image of post 迭代边界" /&gt;&lt;blockquote&gt;
&lt;p&gt;本文是我在几年前学习《VLSI数字信号处理系统设计》这门课程时所做的笔记，此处进行简单整理，以供复习。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;dsp算法及其表示方法&#34;&gt;DSP算法及其表示方法
&lt;/h2&gt;&lt;h3 id=&#34;dsp算法的基本概念&#34;&gt;DSP算法的基本概念
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;DSP算法&lt;/strong&gt;实际上是一个非常简单的概念，即用于 &lt;strong&gt;数字信号处理（Digital Signal Processing, DSP）&lt;/strong&gt; 的算法。从数学角度，即设计一个用于处理数字信号的系统 $\mathscr{H}$ ，使得 $y[n]=\mathscr{H}\{x[n]\}$ 。&lt;/p&gt;
&lt;p&gt;通常，DSP算法可分为&lt;strong&gt;递归DSP算法&lt;/strong&gt;与&lt;strong&gt;非递归DSP算法&lt;/strong&gt;。这两者可通俗理解为&lt;strong&gt;存在反馈的DSP算法&lt;/strong&gt;与&lt;strong&gt;无反馈的DSP算法&lt;/strong&gt;。从&lt;strong&gt;信号流图&lt;/strong&gt;上看，若将信号流图抽象为&lt;strong&gt;有向图&lt;/strong&gt;，则&lt;strong&gt;递归DSP算法&lt;/strong&gt;存在&lt;strong&gt;环路&lt;/strong&gt;，&lt;strong&gt;非递归DSP算法&lt;/strong&gt;不存在环路。&lt;/p&gt;
&lt;p&gt;如果从数学上严格定义，则&lt;strong&gt;递归DSP算法&lt;/strong&gt;指这样一种系统设计 $y[n]=\mathscr{H}\{x[n]\}$ ：系统 $n$ 时刻的输出 $y[n]$ 会受到&lt;strong&gt;过去输出&lt;/strong&gt;的影响，比如： $y[n]=y[n-1]+x[n]$ 。反之，则为&lt;strong&gt;非递归DSP算法&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;dsp算法的表示方法&#34;&gt;DSP算法的表示方法
&lt;/h3&gt;&lt;p&gt;在数字信号处理课程中我们已经知道，可以使用&lt;strong&gt;系统框图&lt;/strong&gt;或&lt;strong&gt;信号流图&lt;/strong&gt;来对一个&lt;strong&gt;DSP算法&lt;/strong&gt;进行描述。而在此，我们将介绍一种新的DSP算法可视化方法： &lt;strong&gt;数据流图（Data-Flow Graph, DFG）&lt;/strong&gt; 。&lt;/p&gt;
&lt;p&gt;DSP算法对应的数据流图可简要理解为DSP算法对应的系统框图&lt;strong&gt;删去输入/输出&lt;/strong&gt;所得的图形&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。进一步，我们可以从数学上对DFG进行严格定义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DFG的严格定义：&lt;strong&gt;对任一DSP算法，其DFG被定义为一&lt;/strong&gt;加权有向图&lt;/strong&gt;  $G(V,E)$ ，其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$\forall u\in G.V$ ，结点 $u$ 均代表算法中的某一操作（加法、乘法，FFT等）&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; ，其权重 $w(u)$ 代表进行该操作的延时，为&lt;strong&gt;某一基本时钟单位&lt;/strong&gt; $T_0$ 的倍数（即实际延时为 $w(u)\cdot T_0$ ）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\forall \langle u,v\rangle\in G.E$ ，&lt;strong&gt;有向边&lt;/strong&gt; $\langle u,v\rangle$ 均代表不同操作间的顺序关系，其权重 $w(u,v)$ 代表该路径上是否存在&lt;strong&gt;延迟模块&lt;/strong&gt;（ $w(u,v)\in \mathbb{N}$ ）：若无延迟模块，则 $w(u,v)=0$ ，若有延迟模块&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;，则说明该路径输入为 $x[n]$ 时，会以 $x[n-w(u,v)]$ 输出， $w(u,v)$ 也为基本时钟单位 $T_0$ 的倍数。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-007/Lec3-1.png&#34;
	width=&#34;1733&#34;
	height=&#34;666&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-007/Lec3-1_hu_fc86fb3cfb264939.png 480w, https://posvirus.github.io/p/dic-007/Lec3-1_hu_35f2f0625e2115fc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;DFG的相关概念&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;260&#34;
		data-flex-basis=&#34;624px&#34;
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;迭代边界的基本概念&#34;&gt;迭代边界的基本概念
&lt;/h2&gt;&lt;h3 id=&#34;基于dfg的相关概念&#34;&gt;基于DFG的相关概念
&lt;/h3&gt;&lt;p&gt;以下，为引出迭代边界，我们先介绍一些基于DFG的基本概念，设某DSP算法对应的DFG为 $G(V,E)$：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关键路径（Critical Path）：&lt;/strong&gt; 指图 $G$ 中的一条&lt;strong&gt;路径&lt;/strong&gt; $l$ ，满足：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$\forall \langle u,v\rangle\in l.E,~w(u,v)=0$ ，即路径上&lt;strong&gt;不存在&lt;/strong&gt;延时模块。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对所有不存在延时模块的路径， $l$ 的&lt;strong&gt;结点权重和&lt;/strong&gt;最大。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关键路径延时（Critical Path Delay）：&lt;/strong&gt; 设图 $G$ 的关键路径为 $l$ ，则其延时 $\displaystyle t_p(l)=\sum\limits_{u\in l.V}w(u)$ 。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;环路周期：&lt;/strong&gt; 设图 $G$ 中存在某环路 $G_0$ ，则其环路周期 $T(G_0)$ 定义为&lt;strong&gt;环路中的关键路径延时&lt;/strong&gt;&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt; （ $T(G_0)$ 也是相对于基本时钟单位的&lt;strong&gt;无量纲量&lt;/strong&gt;）。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以下，我们将基于上述定义，给出一个重要概念：&lt;strong&gt;环路边界&lt;/strong&gt;的定义。首先，在图 $G$ 中取一环路 $G_0$ ，设使其正常运行的最小时钟周期，即&lt;strong&gt;环路周期&lt;/strong&gt;为 $T(G_0)$ ，我们以下的问题是：对一个相同的功能，该如何设计&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;环路 $G_0$ ，才能使 $T(G_0)$ 达到最小？&lt;/p&gt;
&lt;p&gt;为此，我们不妨来考虑 $T(G_0)$ 的理论最小值，首先，我们设环路 $G_0$ 的&lt;strong&gt;延迟模块对应的总延迟&lt;/strong&gt;为：
&lt;/p&gt;
$$
t_p(G_0)=\sum\limits_{\langle u,v\rangle\in G_0.E}w(u,v)
$$&lt;p&gt;
$t_p(G_0)$ 在所有 $G_0$ 设计中应为&lt;strong&gt;常量&lt;/strong&gt;。同时，设环路 $G_0$ 所有&lt;strong&gt;操作对应的总延迟&lt;/strong&gt;为：
&lt;/p&gt;
$$
\tau_p(G_0)=\sum\limits_{u\in G_0.V}w(u)
$$&lt;p&gt;
$\tau_p(G_0)$ 在所有 $G_0$ 设计中也应为&lt;strong&gt;常量&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;因此，我们不妨设某个 $G_0$ 设计共有 $n$ 个结点 $u_1,~u_2,\cdots,~u_n$ （并不妨假定 $u_1,~u_2,\cdots,~u_n$ 顺次排列），则不难发现如下事实：若对 $\langle u,v\rangle\in G_0.E,~w(u,v)=0$，则我们可将 $u,~v$ 等效为一个新结点 $x$ ，并满足 $w(x)=w(u)+w(v)$ 。&lt;/p&gt;
&lt;p&gt;由于 $G_0$ 各边的权重均为&lt;strong&gt;自然数&lt;/strong&gt;，故我们总可在有限步调整后，使 $G_0$ 具有如下性质： $G_0$ 共有 $n&amp;rsquo;(\leqslant n)$ 个结点 $x_1,~x_2,\cdots,~x_{n&amp;rsquo;}$ ，且满足 $\forall \langle x,y\rangle\in G_0.E,~w(x,y)\ne 0$ 。此时我们显然有：
&lt;/p&gt;
$$
T(G_0)=\max\limits_{x\in G_0.V}\{w(x)\}
$$&lt;p&gt;
而进一步即有：
&lt;/p&gt;
$$
T(G_0)=\max\limits_{x\in G_0.V}\{w(x)\}\geqslant\frac{\displaystyle \sum\limits_{x\in G_0.V}w(x)}{n&#39;}=\frac{\tau_p(G_0)}{n&#39;}
$$&lt;p&gt;
注意到此时 $G_0$ 各边的权重均为&lt;strong&gt;正整数&lt;/strong&gt;，则有 ：
&lt;/p&gt;
$$
n&#39;\leqslant \sum\limits_{\langle x,y\rangle\in G_0.E}w(x,y)=t_p(G_0)
$$&lt;p&gt;
因此有：
&lt;/p&gt;
$$
T(G_0)\geqslant \frac{\tau_p(G_0)}{n&#39;}\geqslant \frac{\tau_p(G_0)}{t_p(G_0)}
$$&lt;p&gt;
综上，由于 $\displaystyle \frac{\tau_p(G_0)}{t_p(G_0)}$ 是与设计无关的常量，因此我们得出了环路周期 $T(G_0)$ 的理论最小值，记为 $T_l(G_0)=\displaystyle \frac{\tau_p(G_0)}{t_p(G_0)}$ ，称为该环路的&lt;strong&gt;环路边界&lt;/strong&gt;。而在后面的章节中，我们可以进一步说明，如果仅对单环路 $G_0$ 考查，环路边界 $T_l(G_0)$ 一般总可以通过合理的设计取到。&lt;/p&gt;
&lt;p&gt;一般地，在图 $G$ 中，我们记具有&lt;strong&gt;最大环路边界&lt;/strong&gt;的环路 $G_0$ 为&lt;strong&gt;关键环路&lt;/strong&gt;，关键环路决定了图 $G$ 对应的DSP算法的&lt;strong&gt;速度优化上限&lt;/strong&gt;&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;h3 id=&#34;迭代边界的概念&#34;&gt;迭代边界的概念
&lt;/h3&gt;&lt;p&gt;基于上述概念，以下我们可以给出 &lt;strong&gt;迭代边界（Iteration Bound）&lt;/strong&gt; 的定义：一般地，考查某 DSP算法，其对应的DFG为图 $G$ ，则该DSP算法的迭代边界 $T_\infty(G)$ 定义为图 $G$ 中&lt;strong&gt;关键环路的环路边界&lt;/strong&gt;。特别地，若图 $G$ 为&lt;strong&gt;无环图&lt;/strong&gt;（对应DSP算法为&lt;strong&gt;非递归DSP算法&lt;/strong&gt;），则该DSP算法的迭代边界补充定义为&lt;strong&gt;0&lt;/strong&gt;。使用数学语言描述：
&lt;/p&gt;
$$
T_\infty(G)=\left\{\begin{array}{lcl}
0&amp;&amp;G~\text{is an acyclic graph}\\
\\
\max\{T_l(G_0)|G_0\subset G,~G_0~\text{is a loop}\}&amp;&amp;\text{else}\\
\end{array}
\right.
$$&lt;h3 id=&#34;迭代边界的计算&#34;&gt;迭代边界的计算
&lt;/h3&gt;&lt;p&gt;本节，我们将考查迭代边界的计算，此处我们将介绍一种被称为 &lt;strong&gt;最长路径矩阵法（Longest Path Matrix Algorithm, LPM）&lt;/strong&gt; &lt;sup id=&#34;fnref:7&#34;&gt;&lt;a href=&#34;#fn:7&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;7&lt;/a&gt;&lt;/sup&gt;的算法。需要指出，该算法并不适用于任意图 $G$ 的迭代边界计算，具体而言，图 $G$ 至少需要满足如下条件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;图 $G$ 至少存在一个环（当然，无环图的迭代边界是平凡的）。&lt;/li&gt;
&lt;li&gt;$\forall \langle u,v\rangle\in G.E,~w(u,v)\leqslant 1$ ，即图 $G$ 中的单个延迟模块能且仅能提供&lt;strong&gt;单位延迟&lt;/strong&gt;&lt;sup id=&#34;fnref:8&#34;&gt;&lt;a href=&#34;#fn:8&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;8&lt;/a&gt;&lt;/sup&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以下，我们不妨设图 $G$ 有 $n$ 个结点 $u_1,~u_2,\cdots,~u_n$ ，且在边 $e_1,\cdots,~e_m$ 上分别存在 $m$ 个单位延迟模块 $D_1,~D_2,\cdots,~D_m$ （$D_i$代表一个单位延时模块）。&lt;/p&gt;
&lt;p&gt;同时，我们定义参数 $L^{(s)}_{ij}$ 表示由单位延迟模块 $D_i$ 至 $D_j$ 的路径中，满足经过 $s-1$ 个延迟模块的所有路径的延时的&lt;strong&gt;最大值&lt;/strong&gt;&lt;sup id=&#34;fnref:9&#34;&gt;&lt;a href=&#34;#fn:9&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;9&lt;/a&gt;&lt;/sup&gt;  。如果不存在上述路径，则定义：
&lt;/p&gt;
$$
L_{ij}^{(s)}=-\infty
$$&lt;p&gt;
这里的 $-\infty$ 只是一个标识符，用于代表路径的不存在，在实际算法实现中也常用 $-1$ 代替。&lt;/p&gt;
&lt;p&gt;以下，我们确定 $L^{(s)}_{ij}$ 所成立的递归关系，不妨记 $s\geqslant 2$ ，若要计算由单位延迟模块 $D_i$ 至 $D_j$ 的路径中，满足经过 $s-1$ 个延迟模块的所有路径的延时的&lt;strong&gt;最大值&lt;/strong&gt;，我们仅需遍历所有满足经过 $s-1$ 个延时模块的路径，分别计算各自的延时，并取最大者即可。而对一条由 $D_i$ 至 $D_j$ ，经 $s-1$ 个延时模块的路径而言，我们可取一个中间模块 $D_k$ ，将其视作由 $D_i$ 至 $D_k$ ，不经过延时模块的路径与由 $D_k$ 至 $D_j$ ，经 $s-2$ 个延时模块的路径之和即可。进而，我们仅需对中间模块 $D_k$ 进行遍历即可，因此，我们有：
&lt;/p&gt;
$$
L^{(s)}_{ij}=\max\limits_{1\leqslant k\leqslant m}\{L^{(1)}_{ik}+L^{(s-1)}_{kj}\}
$$&lt;p&gt;
观察该式，有两点需要注意：第一，中间模块 $D_k$ 也可能是 $D_i,~D_j$ 中的一者；第二，对那些不存在的路径，其参数值为 $-\infty$ ，最终的求和结果也必为 $-\infty$ ，代表经过该中间模块的路径不存在。&lt;/p&gt;
&lt;p&gt;为此，我们可直接定义矩阵 $L^{(s)}=(L^{(s)}_{ij})$ ，则上述递归关系也可被表示为一种十分类似于矩阵乘法的形式：&lt;/p&gt;
$$
L^{(s)}=L^{(1)}\oplus L^{(s-1)}
$$&lt;p&gt;算符 $\oplus$ 的含义即为：
&lt;/p&gt;
$$
L^{(s)}_{ij}=\max\limits_{1\leqslant k\leqslant m}\{L^{(1)}_{ik}+L^{(s-1)}_{kj}\} 
$$&lt;p&gt;
以下，我们不难注意到， $L^{(s)}_{ii}$ 描述了由 $D_i$ 回到 $D_i$ 的环路 $G_i$ ，且该环路满足：&lt;/p&gt;
$$
t_p(G_i)=s,~\tau_p(G_i)=L^{(s)}_{ii}
$$&lt;p&gt;其中，$t_p(G_i)=s$ 是因为该环路经过了 $s-1$ 个单位延时模块，再加上 $D_i$ 自身，共 $s$ 个单位延时模块，进而遍历所有环路，我们可知图 $G$ 的&lt;strong&gt;迭代边界&lt;/strong&gt; $T_\infty(G)$ 可表示为：
&lt;/p&gt;
$$
T_\infty(G)=\max\limits_{s\in \mathbb{N}_+}\left\{\left.\frac{L^{(s)}_{ii}}{s}\right| 1\leqslant i\leqslant m\right\}
$$&lt;p&gt;
观察上式，不难发现，其虽然给出了迭代边界 $T_\infty(G)$ 的表达式，但却不能实际用于计算，因为表达式中的 $s$ 需要遍历&lt;strong&gt;所有正整数&lt;/strong&gt;。以下，我们将证明：
&lt;/p&gt;
$$
T_\infty(G)=\max\limits_{s\in \mathbb{N}_+}\left\{\left.\frac{L^{(s)}_{ii}}{s}\right| 1\leqslant i\leqslant m\right\}=\max\limits_{1\leqslant s\leqslant m}\left\{\left.\frac{L^{(s)}_{ii}}{s}\right| 1\leqslant i\leqslant m\right\}
$$&lt;p&gt;
即我们仅需考查延迟模块数不超过 $m$ 的环路对应的环路边界即可。&lt;/p&gt;
&lt;p&gt;首先，考查延迟模块数为 $t$ 的环路 $G_0$ ，并设 $t&amp;gt;m$ ，则若记沿环路方向，遍历延时模块的顺序为：
&lt;/p&gt;
$$
\cdots\rightarrow D_{x_1}\rightarrow D_{x_2}\rightarrow\cdots\rightarrow D_{x_t}\rightarrow\cdots
$$&lt;p&gt;
由于 $t&amp;gt;m$ ，则必存在 $D_{x_i},~D_{x_j}$ （不妨设 $i&amp;lt;j$ ），满足 $x_i=x_j=p$ 。此时，以 $D_p$ 为交点，该环路 $G_0$ 其实是由两个均包含 $D_p$ 的更小环路构成的，我们不妨设两个更小环路的延迟模块数为 $t_1,~t_2$ ，且满足 $t_1+t_2=t$ ，于是有：
&lt;/p&gt;
$$
T(G_0)=\frac{L^{(t)}_{pp}}{t}\leqslant\frac{L_{pp}^{(t_1)}+L^{(t_2)}_{pp}}{t}=\frac{L_{pp}^{(t_1)}+L^{(t_2)}_{pp}}{t_1+t_2}
$$&lt;p&gt;
而易于证明以下不等式成立：
&lt;/p&gt;
$$
\frac{L^{(t_1)}_{pp}+L_{pp}^{(t_2)}}{t_1+t_2}\leqslant \max\left\{\frac{L^{(t_1)}_{pp}}{t_1},~\frac{L^{(t_2)}_{pp}}{t_2}\right\}
$$&lt;p&gt;
因此有：
&lt;/p&gt;
$$
\max\left\{\frac{L^{(t_1)}_{pp}}{t_1},~\frac{L^{(t_2)}_{pp}}{t_2}\right\}\geqslant T(G_0)
$$&lt;p&gt;
此即说明环路 $G_0$ 不可能是&lt;strong&gt;关键环路&lt;/strong&gt;，而对包含 $t_1,~t_2$ 个延时模块的环路，若 $t_1,~t_2$ 仍大于 $m$ ，则我们可继续对其进行拆分，直至环路包含的延迟个数不超过 $m$ ，进而便证明了延迟模块数超过 $m$ 的环路不可能是关键环路。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;之所以要删去输入/输出，是因为DFG仅关心数据在系统内部的流动，用于描述DSP算法一轮运算（或称为&lt;strong&gt;迭代&lt;/strong&gt;）的过程。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;根据结点对操作的抽象程度，结点可分为&lt;strong&gt;粗粒度（结点为子任务以上层次的复杂功能块，如滤波、 FFT等）&lt;strong&gt;与&lt;/strong&gt;细粒度（结点简单到基本运算单元，如乘法、加法等）&lt;/strong&gt;。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;延时模块的硬件实现即为我们熟知的&lt;strong&gt;寄存器（Register）&lt;/strong&gt;，具体原理即：在某一时钟周期将信号 $x[n]$ 放入寄存器，等待 $k$ 个时钟周期后再取出，则此时的输出信号即为 $x[n-k]$ 。&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;此处的定义看似有些奇怪，因为我们似乎希望环路周期是数据在环路完整运行一周对应的时间，但事实上，此处定义的环路周期的意义是：&lt;strong&gt;该环路正常运行所需的最小时钟周期&lt;/strong&gt;，即 $T(G_0)$ （相对于基本时钟单位的无量纲量）。这是因为，与该环路对应的关键路径 $l$ 相邻的有向边上一定存在延时模块（寄存器） $D_1,~D_2$ （否则我们可以将相邻有向边加入 $l$ 构成更长的路径（由于是环路，方向肯定没问题），与 $l$ 为关键路径矛盾！），而每一个时钟周期内，数据必须完成在 $D_1,~D_2$ 间的传递，否则电路运行就会出错（可以理解为环路中的数据是以时钟周期为单位&lt;strong&gt;同步&lt;/strong&gt;流动的，有一处在时钟周期内没有完成流动，将会导致其余部分模块输出的错误），因此该环路的时钟周期必然不能小于 $T(G_0)$ 。&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34;&gt;
&lt;p&gt;此处的设计指合理分配环路中的延时模块与操作模块，具体的设计方法称为&lt;strong&gt;重定时（Retiming）&lt;/strong&gt;，我们将在后面的章节中予以介绍。&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:6&#34;&gt;
&lt;p&gt;当然，关键环路决定DSP算法速度优化上限的前提是DSP算法对应DFG中&lt;strong&gt;存在环路&lt;/strong&gt;，即DSP算法为&lt;strong&gt;递归DSP算法&lt;/strong&gt;。这从一个侧面反应了，对&lt;strong&gt;非递归DSP算法&lt;/strong&gt;而言，对其速度的优化是没有上限的（理论上限，不考虑硬件的性能）。比如 $y[n]=3\cdot x[n]+4$ ，如果我们使用 $m$ 条并行通路对该DSP算法进行实现，该算法的性能便被优化 $m$ 倍，又由于该算法仅存在由输入至输出的单向通路，因此 $m$ 可以趋向 $\infty$ 。&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:7&#34;&gt;
&lt;p&gt;Gerez S H, De Groot S M H, Herrmann O E. A polynomial time algorithm for the computation of the iteration-period bound in recursive data flow graphs[J]. IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications, 1992, 39(1): 49-52.&amp;#160;&lt;a href=&#34;#fnref:7&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:8&#34;&gt;
&lt;p&gt;当然，对延迟数超过1的边，我们完全可以将延迟模块拆分为若干单位延迟模块的并联，并将各单位延时模块间插入权重为&lt;strong&gt;0&lt;/strong&gt;的结点进行等效。&amp;#160;&lt;a href=&#34;#fnref:8&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:9&#34;&gt;
&lt;p&gt;明确两个概念：第一， $D_i$ 至 $D_j$ 的路径指的是一条路径 $l$ ，其起点与终点分别为边 $e_i$ 与 $e_j$ 的某端点；第二，路径 $l$ 对应的延时指路径上所有结点的权重和。&amp;#160;&lt;a href=&#34;#fnref:9&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>基带信号的调制与解调</title>
        <link>https://posvirus.github.io/p/dic-006/</link>
        <pubDate>Sat, 29 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-006/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-006/cicc.png" alt="Featured image of post 基带信号的调制与解调" /&gt;&lt;blockquote&gt;
&lt;p&gt;本文是我在几年前学习《VLSI数字信号处理系统设计》这门课程时所做的笔记，此处进行简单整理，以供复习。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;数字基带传输&#34;&gt;数字基带传输
&lt;/h2&gt;&lt;h3 id=&#34;数字基带传输系统&#34;&gt;数字基带传输系统
&lt;/h3&gt;&lt;p&gt;在本节中，我们将首先考查数字基带传输系统进行信号传输，在&lt;a class=&#34;link&#34; href=&#34;https://posvirus.github.io/p/dic-005/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;第一章&lt;/a&gt;中已经说明过，所谓数字基带传输系统，即为不经载波调制而直接传输数字基带信号的&lt;strong&gt;数字通信系统&lt;/strong&gt;，常用于传输距离不太远的情况。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-1.png&#34;
	width=&#34;1685&#34;
	height=&#34;584&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-1_hu_d918c2cf0de4e749.png 480w, https://posvirus.github.io/p/dic-006/Lec2-1_hu_62205ec321f7066f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;数字通信系统的工作流图&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;288&#34;
		data-flex-basis=&#34;692px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;我们仍然可以使用如上图所示的一般数字通信系统的&lt;strong&gt;Work-flow Chart&lt;/strong&gt;来对数字基带传输系统进行可视化理解（毕竟其也为一类数字通信系统），原始信号在进行&lt;strong&gt;量化&lt;/strong&gt;、&lt;strong&gt;信源编码（Source encode）&lt;/strong&gt; 与&lt;strong&gt;信道编码（Channel encode）&lt;/strong&gt; 后成功生成了一个&lt;strong&gt;二进制序列&lt;/strong&gt;（ $0101001\cdots$ ），而注意，此时的二进制序列仍然只是一个抽象的数字序列，要将其转化为可实际进行传输的信号，我们需要将该数字序列&lt;strong&gt;整合&lt;/strong&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;至脉冲波形上，形成实际的数字基带信号。在此之后，直接对数字基带信号进行传输，并通过接收端的&lt;strong&gt;采样&lt;/strong&gt;、&lt;strong&gt;解码&lt;/strong&gt;等操作恢复原始的二进制序列信息。&lt;/p&gt;
&lt;h3 id=&#34;几类常用的基带信号&#34;&gt;几类常用的基带信号
&lt;/h3&gt;&lt;p&gt;而首先，我们需了解数字基带传输系统中常用的几类基带信号：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-2.png&#34;
	width=&#34;964&#34;
	height=&#34;208&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-2_hu_33e2ab475ae52cb2.png 480w, https://posvirus.github.io/p/dic-006/Lec2-2_hu_1109982c5f48c69e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;数字通信系统的工作流图&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;463&#34;
		data-flex-basis=&#34;1112px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;矩形脉冲：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\left\{\begin{array}{lcl}
A&amp;&amp;|t|\leqslant T_c\\
\\
0&amp;&amp;\text{else}
\end{array}\right.
$$&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;三角脉冲：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\left\{\begin{array}{lcl}
\displaystyle\frac{A}{T_c}(t+T_c)&amp;&amp;-T_c\leqslant t&lt;0\\
\\
\displaystyle-\frac{A}{T_c}(t-T_c)&amp;&amp;0\leqslant t\leqslant T_c\\
\\
0&amp;&amp;\text{else}
\end{array}\right.
$$&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;高斯脉冲：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\frac{1}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{t^2}{2\sigma^2}}
$$&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;升余弦脉冲：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\left\{\begin{array}{lcl}
\displaystyle \frac{A}{2}\left[1+\cos\left(\frac{\pi t}{T_c}\right)\right]&amp;&amp;|t|\leqslant T_c\\
\\
0&amp;&amp;\text{else}
\end{array}\right.
$$&lt;p&gt;其中，考虑到各脉冲在现实应用场景中的生成难度，最常用的基带信号为&lt;strong&gt;升余弦脉冲&lt;/strong&gt;，但为保证说明的形象性与简洁性，在后文我们统一采用&lt;strong&gt;矩形脉冲&lt;/strong&gt;进行讨论。&lt;/p&gt;
&lt;p&gt;这里需要补充说明两个问题：&lt;/p&gt;
&lt;p&gt;第一，上述这些信号虽被称为基带信号，但它们是符合严格数学定义的基带信号吗？不妨以矩形脉冲为例，对其进行Fourier变换：&lt;/p&gt;
$$
F(\omega)=\mathscr{F}\{f(t)\}=\int_{-T_c}^{+T_c}A\mathrm{e}^{-i\omega t}\mathrm{d}t=\frac{A\sin(\omega T_c)}{\omega}=AT_c\cdot\text{Sinc}(T_c\omega)
$$&lt;p&gt;
可见，矩形脉冲具有无限宽的频谱，从数学意义上并不是基带信号（其实从更广义的角度而言，在时域上有限的信号往往在频域上无限），那么，我们为何称其为基带信号呢？仍以矩形脉冲为例，我们注意到， $F(\omega)=\displaystyle \frac{A\sin(\omega T_c)}{\omega}$ 除在 $[-\pi/T_c,~\pi/T_c]$ 上取值较大（&lt;strong&gt;主瓣&lt;/strong&gt;）外，在其余区域内（&lt;strong&gt;旁瓣&lt;/strong&gt;）频谱的取值都非常接近0，这就说明，虽然 $F(\omega)$ 是无限宽的频谱，但它其实与基带信号的频谱是十分相似的。&lt;/p&gt;
&lt;p&gt;当然， $F(\omega)$ 与基带信号的频谱相似并不代表着我们可以直接把矩形脉冲当作基带信号使用，但我们确实可以利用这种相似性将矩形脉冲转化为基带信号，这一过程一般称为&lt;strong&gt;脉冲/基带成型&lt;/strong&gt;：即使用一个&lt;strong&gt;低通滤波器&lt;/strong&gt;滤去 $F(\omega)$ 的高频分量，将滤波后的信号作为基带信号使用，而 $F(\omega)$ 与基带信号频谱的相似性保证了在滤波后，矩形脉冲的时域波形不会发生太大改变。由于脉冲成型是一个相对独立的处理过程，且滤波后的波形的解析表达式在形式上又过于复杂，因此我们常常直接称矩形脉冲信号（以及上述这些信号）为基带信号。&lt;/p&gt;
&lt;p&gt;第二，上述信号所代表的仅仅为&lt;strong&gt;单个脉冲&lt;/strong&gt;，而若要传输一个二进制序列，往往需要在一段连续时间内多个脉冲的叠加，即：
&lt;/p&gt;
$$
f(t)=\sum\limits_{i=0}^{+\infty}a_ig(t-iT_B)
$$&lt;p&gt;
其中 $g(t)$ 为单个基带脉冲，而我们注意到：
&lt;/p&gt;
$$
\mathscr{F}\{g(t-t_0)\}=\int_{-\infty}^{+\infty}g(t-t_0)\mathrm{e}^{-i\omega(t-t_0)}\cdot\mathrm{e}^{-i\omega t_0}\mathrm{d}t=\mathscr{F}\{g(t)\}\cdot\mathrm{e}^{-i\omega t_0}
$$&lt;p&gt;
因此我们得到一个重要事实：&lt;strong&gt;基带信号在时域上平移叠加后的信号仍为基带信号&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;二进制序列与脉冲波形的对应关系&#34;&gt;二进制序列与脉冲波形的对应关系
&lt;/h3&gt;&lt;p&gt;在完成对几类基带信号的说明后，以下我们将以&lt;strong&gt;矩形脉冲&lt;/strong&gt;为例，探讨二进制序列与脉冲波形的对应关系：&lt;/p&gt;
&lt;p&gt;由于二进制序列从本质上而言仅有0和1两个基本元素，因此我们仅需考虑脉冲波形的（电平）取值与0和1的对应关系即可，我们常将这种对应关系称为&lt;strong&gt;二元传输码&lt;/strong&gt;的&lt;strong&gt;传输码型&lt;/strong&gt;，主要有以下几类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;单极性非归零码（Unipolar Non-return-to-zero Coding）：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;用一种信号电平代表1，用另一种信号电平代表0，在码元&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;持续期间电平保持不变。如用高电平代表1，低电平（一般为零电平）代表0，为&lt;strong&gt;正逻辑&lt;/strong&gt;，反之为&lt;strong&gt;负逻辑&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;双极性非归零码（Bipolar Non-return-to-zero Coding）：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;用正电平和负电平分别表示1和0，在码元持续期间电平保持不变。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;注：&lt;/strong&gt; 单极性码与双极性码的特点比较：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;单极性码&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;双极性码&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;1. 有直流分量，无法使用一些交流耦合的线路和设备；2. 判决电平不能稳定在最佳的电平，即抗噪性能差；3. 传输时需一端接地。不能用两根芯线均不接地的电缆传输线。（用于设备内部和数字调制器中）&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;1.直流分量小。当二进制序列中1和0等可能出现时，无直流成分；2.接收端判决门限为0，容易设置并且稳定，因此抗干扰能力强；3.可以在电缆等无接地线上传输。（RS-232C接口标准和数字调制器中）&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;单极性归零码（Unipolar Return-to-zero Coding）：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;单极性归零码与单极性非归零码稍有区别，具体表现为：&lt;strong&gt;高电平&lt;/strong&gt;不是在整个码元期间保持不变，而是只持续一段时间，然后在码元的其余时间内返回到零电平。以正逻辑为例，这种码在表示1时，信号会在一个码元宽度（记为 $T_s$ ）内先保持一段时间（记为 $\tau$ ）的高电平，并在剩余时间切换为零电平；在表示0时则仍始终为低电平。我们同时称 $\tau/T_s$ 为这种码型的&lt;strong&gt;占空比&lt;/strong&gt;，一般地， $\tau/T_s=0.5$ 。&lt;/p&gt;
&lt;p&gt;单极性归零码可直接提取&lt;strong&gt;位同步&lt;/strong&gt;信号，可作为其他码型提取同步时钟的过渡码型。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;双极性归零码（Bipolar Return-to-zero Coding）：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;正电平与负电平在整个码元期间均不是保持不变的，而是只持续一段时间，然后在码元的其余时间内返回到零电平。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;差分波形：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不是用码元本身的电平表示二进制序列，而是用相邻码元的电平的跳变和不变来表示二进制序列，分为&lt;strong&gt;传号差分&lt;/strong&gt;与&lt;strong&gt;空号差分&lt;/strong&gt;：考虑第 $k$ 个码元的电平 $E_k$ 与第 $k+1$ 个码元的电平 $E_{k+1}$ ，对传号差分，若 $E_{k}=E_{k+1}$ ，则第 $k+1$ 个码元代表0；若 $E_k\ne E_{k+1}$ ，则第 $k+1$ 个码元代表1，对空号差分则相反。&lt;/p&gt;
&lt;p&gt;差分波形可以消除设备初始状态不确定性带来的影响。同时，由于差分波形是以相邻脉冲电平的相对变化来表示二进制序列的，因此称它为&lt;strong&gt;相对码&lt;/strong&gt;，而相应地称前面的码型为&lt;strong&gt;绝对码&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;多进制波形：&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用超过两个电平的脉冲波形表示二进制序列，根据所使用电平的数量，各电平可包含多个比特的信息（一般地，如使用 $N$ 个电平，则每个电平至多可包含 $\lfloor\log_2 N\rfloor~\text{bit}$ 的序列信息）。&lt;/p&gt;
&lt;p&gt;对多进制波形，&lt;strong&gt;传码率&lt;/strong&gt;&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;一定时，其&lt;strong&gt;传信率&lt;/strong&gt;&lt;sup id=&#34;fnref1:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;高，可用于高数据速率传输系统。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-3.png&#34;
	width=&#34;1056&#34;
	height=&#34;453&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-3_hu_fc3aa43c1cba80bc.png 480w, https://posvirus.github.io/p/dic-006/Lec2-3_hu_be10357afdf97ccb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;各类传输码型的示意图&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;233&#34;
		data-flex-basis=&#34;559px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;数字基带信号的表达式&#34;&gt;数字基带信号的表达式
&lt;/h3&gt;&lt;p&gt;在不考虑二进制序列所包含的具体信息的前提下（即考查&lt;strong&gt;随机生成的二进制序列&lt;/strong&gt;），我们可将一个随机二进制序列对应的数字基带信号记作 $f(t)$ ，其可表示如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当&lt;strong&gt;各码元波形相同而取值不同&lt;/strong&gt;时：&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\sum\limits_{n=-\infty}^{+\infty}a_ng(t-nT_s)
$$&lt;p&gt;其中，${a_n}$ 为离散型随机变量， $T_s$ 为码元宽度。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当&lt;strong&gt;0/1使用不同波形表示&lt;/strong&gt;时：&lt;/li&gt;
&lt;/ul&gt;
$$
f(t)=\sum\limits_{n=-\infty}^{+\infty}g_n(t),~g_n(t)=\left\{\begin{array}{lcl}
g_{(1)}(t-nT_s)&amp;&amp;\text{with probability of}~p\\
\\
g_{(0)}(t-nT_s)&amp;&amp;\text{with probability of}~1-p\\
\end{array}\right.
$$&lt;p&gt;其中， $p$ 为二进制序列中1出现的概率。&lt;/p&gt;
&lt;h2 id=&#34;基带信号解调与检测&#34;&gt;基带信号解调与检测
&lt;/h2&gt;&lt;h3 id=&#34;噪声的来源简述&#34;&gt;噪声的来源简述
&lt;/h3&gt;&lt;p&gt;在上节中，我们考查了&lt;strong&gt;数字基带传输系统&lt;/strong&gt;的原始信息编码，以下，我们将对传输系统的后半部分，即信号的&lt;strong&gt;传输&lt;/strong&gt;与&lt;strong&gt;接收&lt;/strong&gt;进行说明。我们首先考查信号的传输，在实际的信号传输过程中，由于受到外界各类因素的干扰，因此会在信号传输过程中引入&lt;strong&gt;噪声（Noise）&lt;/strong&gt;。我们对信号传输过程的研究，也是这些噪声为重点的。&lt;/p&gt;
&lt;p&gt;噪声一般分为两类，外界因素引起的噪声（我们一般称为&lt;strong&gt;热噪声（Thermal Noise）&lt;/strong&gt;），以及因传输信息的脉冲波形的非理想特性所引起的噪声（一般称为&lt;strong&gt;码间串扰（Inter-Symbol Interference, ISI）&lt;/strong&gt;），具体内容如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;热噪声：&lt;/strong&gt; 一般用于仿真热噪声的数学模型被称为&lt;strong&gt;加性高斯白噪声模型（Addictive White Gaussian Noise, AWGN）&lt;/strong&gt;，是最基本的噪声与干扰模型，其可使用 $n(t)$ 进行描述，对加性高斯白噪声 $n(t)$ 而言，其应当满足如下条件：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;加性：&lt;/strong&gt; 噪声 $n(t)$ 是直接叠加在信号波形上的，且无论信号是否存在，噪声都始终存在。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;白噪声：&lt;/strong&gt; 噪声 $n(t)$ 的&lt;strong&gt;功率谱&lt;/strong&gt;&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;为常数。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;高斯噪声：&lt;/strong&gt; 噪声取值的概率分布满足&lt;strong&gt;正态分布&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;注：&lt;/strong&gt; 噪声是随机信号，$n(t)$ 只是形式上的记法，我们应从统计意义上对其进行分析。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;码间串扰：&lt;/strong&gt; 我们将在后面的章节中讨论，此处从略。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;接收系统的组成&#34;&gt;接收系统的组成
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-4.png&#34;
	width=&#34;1361&#34;
	height=&#34;267&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-4_hu_94a79e509cf06e9f.png 480w, https://posvirus.github.io/p/dic-006/Lec2-4_hu_f72f42eee5c462bf.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;接收系统的组成&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;509&#34;
		data-flex-basis=&#34;1223px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;上图展示了数字基带传输系统中接收系统的组成，读图可知，接收系统主要由&lt;strong&gt;接收滤波器&lt;/strong&gt;与&lt;strong&gt;抽样判决器&lt;/strong&gt;组成，两者的作用具体如下所示：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;接收滤波器/匹配滤波器：&lt;/strong&gt; 滤除带外噪声，恢复具有&lt;strong&gt;最大信噪比&lt;/strong&gt;的基带脉冲，使输出的基带波形有利于抽样判决。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;抽样判决器：&lt;/strong&gt; 对接收滤波器的输出波形进行抽样判决（即依据波形取值判断二进制0/1），确定发送的二进制序列。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;同步提取：&lt;/strong&gt; 提取用于抽样的位同步脉冲。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;而对&lt;strong&gt;接收滤波器&lt;/strong&gt;而言，在进行基带脉冲恢复的前后，还需要分别通过&lt;strong&gt;频率下搬移&lt;/strong&gt;与&lt;strong&gt;均衡滤波器&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-5.png&#34;
	width=&#34;1265&#34;
	height=&#34;509&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-5_hu_2aa0d38cf8028544.png 480w, https://posvirus.github.io/p/dic-006/Lec2-5_hu_de27f66cba642698.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;频率下搬移与均衡滤波器&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;248&#34;
		data-flex-basis=&#34;596px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;其中，&lt;strong&gt;频率下搬移&lt;/strong&gt;是指将接收到的&lt;strong&gt;带通信号&lt;/strong&gt;重构为&lt;strong&gt;基带信号&lt;/strong&gt;，当然，这仅对&lt;strong&gt;带通传输系统&lt;/strong&gt;是必要的，对本节所讨论的&lt;strong&gt;数字基带传输系统&lt;/strong&gt;则无必要；而&lt;strong&gt;均衡滤波器&lt;/strong&gt;则用于消除&lt;strong&gt;码间串扰&lt;/strong&gt;，当然，如果不考虑码间串扰的影响，则均衡滤波器也是不必要的。&lt;/p&gt;
&lt;h2 id=&#34;信号与噪声&#34;&gt;信号与噪声
&lt;/h2&gt;&lt;h3 id=&#34;awgn噪声模型&#34;&gt;AWGN噪声模型
&lt;/h3&gt;&lt;p&gt;在本节，我们将对上节提到的&lt;strong&gt;AWGN噪声模型&lt;/strong&gt;进行量化分析，首先，我们假设传输的二进制序列为随机序列：
&lt;/p&gt;
$$
s(t)=\sum\limits_{n=-\infty}^{+\infty}s_n(t),~s_n(t)=\left\{\begin{array}{lcl}
s_{(1)}(t-nT_s)&amp;&amp;\text{for a binary 1, with probability of}~p\\
\\
s_{(0)}(t-nT_s)&amp;&amp;\text{for a binary 0, with probability of}~1-p\\
\end{array}\right.
$$&lt;p&gt;
其中， $s_0(t),~s_1(t)$ 分别为代表0和1的脉冲波形，码元宽度为 $T_s$ 。同时，我们记AWGN噪声为 $n(t)$ ，则传输基带信号 $s(t)$ 的信道可抽象为如下系统：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-6.png&#34;
	width=&#34;515&#34;
	height=&#34;219&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-6_hu_2b20534ec71ba260.png 480w, https://posvirus.github.io/p/dic-006/Lec2-6_hu_6ffb1b23ebd60302.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;信道的系统抽象&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;235&#34;
		data-flex-basis=&#34;564px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;其中 $h_c(t)=\delta(t)$ 为一个&lt;strong&gt;单位无失真传输系统&lt;/strong&gt;，输入信号与输出信号完全相等， $s(t)$ 在通过该系统后，与AWGN噪声 $n(t)$ 线性叠加，假设输出信号为 $z(t)$ ，则成立：
&lt;/p&gt;
$$
z(t)=s(t)+n(t)
$$&lt;p&gt;
我们固定某一时间点 $\tau$ 对上式研究，假设上式可记作：
&lt;/p&gt;
$$
z(\tau)=s_i(\tau)+n(\tau)=\left\{\begin{array}{lcl}
a_{(1)}+n(\tau)&amp;&amp;\text{for a binary 1, with probability of}~p\\
\\
a_{(0)}+n(\tau)&amp;&amp;\text{for a binary 0, with probability of}~1-p\\
\end{array}\right.
$$&lt;p&gt;
可知，当该时间点传输的码元为&lt;strong&gt;1&lt;/strong&gt;时（将该事件记为 $S_{(1)}$ ， $p(S_{(1)})=p$ ），则 $z(\tau)=a_{(1)}+n(\tau)$ ;当该时间点传输的码元为&lt;strong&gt;0&lt;/strong&gt;时（将该事件记为 $S_{(0)}$ ， $p(S_{(0)})=1-p$ ），则 $z(\tau)=a_{(0)}+n(\tau)$ 。&lt;/p&gt;
&lt;p&gt;而注意到，当固定时间点 $\tau$ 时，$n(\tau)$ 是一个服从正态分布的随机变量， $a_{(1)},~a_{(0)}$ 默认为常数，我们记：
&lt;/p&gt;
$$
n(\tau)\sim N(0,~\sigma^2)
$$&lt;p&gt;
则显然 $z(\tau)$ 也是一个随机变量，满足：
&lt;/p&gt;
$$
z(\tau)\sim \left\{\begin{array}{lcl}
N(a_{(1)},~\sigma^2)&amp;&amp;\text{for a binary 1, with probability of}~p\\
\\
N(a_{(0)},~\sigma^2)&amp;&amp;\text{for a binary 0, with probability of}~1-p\\
\end{array}\right.
$$&lt;p&gt;
或也可用&lt;strong&gt;概率密度函数&lt;/strong&gt;的形式写作：
&lt;/p&gt;
$$
\rho(z|S_{(1)})=\frac{1}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{(z-a_{(1)})^2}{2\sigma^2}},~\rho(z|S_{(0)})=\frac{1}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{(z-a_{(0)})^2}{2\sigma^2}}
$$&lt;p&gt;
进一步，依据条件概率公式，我们有：
&lt;/p&gt;
$$
\rho(z)=p\rho(z|S_{(1)})+(1-p)\rho(z|S_{(0)})=\frac{p}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{(z-a_{(1)})^2}{2\sigma^2}}+\frac{1-p}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{(z-a_{(0)})^2}{2\sigma^2}}
$$&lt;p&gt;
$\rho(z)$ 给出了 $\tau$ 时刻的接收信号 $z(\tau)$ 服从的概率分布，事实上一般性地也给出了任意时刻接收信号服从的概率分布（因为 $\sigma^2,~a_{(0)},~a_{(1)}$ 均是独立于时间的变量），而我们最终需要依据该概率密度函数确定一个&lt;strong&gt;判决门限&lt;/strong&gt; $\gamma$ （当然也是独立于时间的），当实际接收的信号 $\hat{z}(\tau)&amp;gt;\gamma$ 时，判定该码元表示二进制1；当实际接收的信号 $\hat{z}(\tau)&amp;lt;\gamma$ 时，判定该码元表示二进制0（以下，均使用&lt;strong&gt;正逻辑&lt;/strong&gt;作为代表）。&lt;/p&gt;
&lt;p&gt;当然，由于 $z$ 是连续型随机变量，这就表明，无论我们如何选取判决门限 $\gamma$ ，总不能将&lt;strong&gt;误码&lt;/strong&gt;的概率降至0，而在信号传输的过程中，我们希望能够将误码的概率降至最低，这一准则一般称为&lt;strong&gt;最小错误概率准则&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;信噪比&#34;&gt;信噪比
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;信噪比（Signal-noise Ratio, SNR）&lt;/strong&gt; 是描述信号传输中噪声的一个重要参量，若记 接收信号在 $t=\tau$ 时的&lt;strong&gt;瞬时功率&lt;/strong&gt;为 $P(\tau)$ ，噪声在 $t=\tau$ 时的&lt;strong&gt;平均功率&lt;/strong&gt;&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;为 $N(\tau)$ ，则信噪比被定义为：
&lt;/p&gt;
$$
\text{SNR}=\frac{P(\tau)}{N(\tau)}
$$&lt;p&gt;
同时，利用上节中的AWGN噪声模型，我们易于给出 $P(\tau),~N(\tau)$ 的具体表达式，仅需注意到：
&lt;/p&gt;
$$
P(\tau)=\lim\limits_{T\to 0}\frac{1}{T}\int_{\tau-T/2}^{\tau+T/2}z^2(t)\mathrm{d}t=z^2(\tau)
$$&lt;p&gt;
以及：
&lt;/p&gt;
$$
N(\tau)=E[n^2(\tau)]
$$&lt;p&gt;
同时，我们若记&lt;strong&gt;各码元的平均能量&lt;/strong&gt;为 $E_s$ ，&lt;strong&gt;每比特的平均能量&lt;/strong&gt;为 $E_b$ ， &lt;strong&gt;传码率&lt;/strong&gt;为 $R_s$ ，&lt;strong&gt;传信率&lt;/strong&gt;为 $R_b$ ，则应当成立：
&lt;/p&gt;
$$
\frac{E_s}{E_b}=\frac{R_b}{R_s}=k
$$&lt;p&gt;
$k$ 即为&lt;strong&gt;每个码元传输的比特数&lt;/strong&gt;，因此有：
&lt;/p&gt;
$$
\bar{P}=\frac{E_s}{T_s}=E_sR_s=E_bR_b,~\bar{N}=\frac{N_0W}{2}
$$&lt;p&gt;
其中 $W$ 为噪声功率谱的带宽（虽然白噪声功率谱的带宽理论上是无穷大，但在实际中应当是一个有限值 $W$ ），噪声的功率谱记为 $\displaystyle P_s(\omega)=\frac{N_0}{2}$ ，进而有：
&lt;/p&gt;
$$
\text{SNR}=\frac{E_b}{N_0}\cdot\frac{2R_b}{W}
$$&lt;p&gt;
参量 $\displaystyle\frac{E_b}{N_0}$ 有时也作为衡量数字通信系统性能的重要指标之一。&lt;/p&gt;
&lt;p&gt;在信号传输过程中，我们同样希望接收信号的信噪比能够尽可能大，这一准则一般称为&lt;strong&gt;最大输出信噪比准则&lt;/strong&gt;。&lt;/p&gt;
&lt;h2 id=&#34;匹配滤波器&#34;&gt;匹配滤波器
&lt;/h2&gt;&lt;h3 id=&#34;匹配滤波器的基本形式&#34;&gt;匹配滤波器的基本形式
&lt;/h3&gt;&lt;p&gt;在上节中我们了解到，利用&lt;strong&gt;接收滤波器/匹配滤波器&lt;/strong&gt;对接收信号进行处理，可以改善接收信号的信噪比，以下，我们记匹配滤波器的&lt;strong&gt;系统函数&lt;/strong&gt;为 $h(t)$ ，探究当 $h(t)$ 满足何种表达式时，输出信号 $y(t)$ 的信噪比最低。&lt;/p&gt;
&lt;p&gt;为此，我们假设接收系统会在 $t=t_0$ 时刻进行抽样，不妨仅考查 $t=t_0$ 这一时刻的信噪比，并不妨设首先计算输出信号 $y(t)$ 的表达式：
&lt;/p&gt;
$$
y(t_0)=z(t_0)*h(t_0)=\int_{-\infty}^{+\infty}z(\tau)h(t_0-\tau)\mathrm{d}\tau=\int_{-\infty}^{+\infty}(s(\tau)+n(\tau))h(t_0-\tau)\mathrm{d}\tau
$$&lt;p&gt;
进而可记：
&lt;/p&gt;
$$
y_s(t_0)=\int_{-\infty}^{+\infty}s(\tau)h(t_0-\tau)\mathrm{d}\tau,~y_n(t_0)=\int_{-\infty}^{+\infty}n(\tau)h(t_0-\tau)\mathrm{d}\tau
$$&lt;p&gt;于是有：
&lt;/p&gt;
$$
\text{SNR}(t_0)=\frac{y_s^2(t_0)}{E[y_n^2(t_0)]}
$$&lt;p&gt;
以下我们重点考查 $E[y_n^2(t_0)]$ 的计算，将其展开，有：
&lt;/p&gt;
$$
E[y_n^2(t_0)]=E\left[\left(\int_{-\infty}^{+\infty}n(\tau)h(t_0-\tau)\mathrm{d}\tau\right)^2\right]=E\left[\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}n(\tau)n(t)h(t_0-\tau)h(t_0-t)\mathrm{d}\tau\mathrm{d}t\right]
$$&lt;p&gt;
而由于积分运算的线性性质，我们有：
&lt;/p&gt;
$$
E[y_n^2(t_0)]=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}E[n(\tau)n(t)]h(t_0-\tau)h(t_0-t)\mathrm{d}\tau\mathrm{d}t
$$&lt;p&gt;
其中，$R(t-\tau)=E[n(\tau)n(t)]$ 一般被称为&lt;strong&gt;自相关函数&lt;/strong&gt;，利用 &lt;strong&gt;维纳-辛钦定理（Wiener–Khinchin Theorem）&lt;/strong&gt; 可得：若记 $n(t)$ 对应的功率谱为 $\displaystyle P_s(\omega)=\frac{N_0}{2}$ ，则 $\displaystyle R(\tau)=\mathscr{F}^{-1}\{P_s(\omega)\}=\frac{N_0}{2}\delta(\tau)$ ，因此有：
&lt;/p&gt;
$$
E[y_n^2(t_0)]=\frac{N_0}{2}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}\delta(t-\tau)h(t_0-\tau)h(t_0-t)\mathrm{d}\tau\mathrm{d}t=\frac{N_0}{2}\int_{-\infty}^{+\infty}h^2(t_0-\tau)\mathrm{d}\tau
$$&lt;p&gt;
因此就有：
&lt;/p&gt;
$$
\text{SNR}(t_0)=\frac{\displaystyle\left|\int_{-\infty}^{+\infty}s(\tau)h(t_0-\tau)\mathrm{d}\tau\right|^2}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}h^2(t_0-\tau)\mathrm{d}\tau}=\frac{\displaystyle\left|\int_{-\infty}^{+\infty}s(t_0-\tau)h(\tau)\mathrm{d}\tau\right|^2}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}h^2(\tau)\mathrm{d}\tau}
$$&lt;p&gt;
而若记 $S(f)=\mathscr{F}\{s(t)\},~H(f)=\mathscr{F}\{h(t)\}$ （此处， $f$ 为&lt;strong&gt;频率&lt;/strong&gt;而非&lt;strong&gt;角频率&lt;/strong&gt;），则有：
&lt;/p&gt;
$$
\mathscr{F}\{s(t_0-t)\}=S^*(f)\cdot\mathrm{e}^{-2\pi ft_0}
$$&lt;p&gt;
利用&lt;strong&gt;Parseval定理&lt;/strong&gt;，可计算得：
&lt;/p&gt;
$$
\text{SNR}(t_0)=\frac{\displaystyle\left|\int_{-\infty}^{+\infty}H(f)S(f)\cdot\mathrm{e}^{2\pi ft_0}\mathrm{d}f\right|}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}|H(f)|^2\mathrm{d}f}
$$&lt;p&gt;
利用&lt;strong&gt;Cauchy-Schwartz不等式&lt;/strong&gt;，则有：
&lt;/p&gt;
$$
\text{SNR}(t_0)\leqslant\frac{\displaystyle\int_{-\infty}^{+\infty}|S(f)\cdot\mathrm{e}^{2\pi ft_0}|^2\mathrm{d}f\cdot \int_{-\infty}^{+\infty}|H(f)|^2\mathrm{d}f}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}|H(f)|^2\mathrm{d}f}=\frac{2\displaystyle\int_{-\infty}^{+\infty}|S(f)\cdot\mathrm{e}^{2\pi ft_0}|^2\mathrm{d}f}{N_0}=\frac{2\displaystyle\int_{-\infty}^{+\infty}|S(f)|^2\mathrm{d}f}{N_0}
$$&lt;p&gt;
以下，为方便讨论，我们不妨仅考查&lt;strong&gt;第一个码元&lt;/strong&gt;，即认为 $s(t)$ 仅在 $[0,~T_s]$ 上非0&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;，并设 $t_0\in[0,~T_s]$ ，于是有：
&lt;/p&gt;
$$
\int_{-\infty}^{+\infty}|S(f)|^2\mathrm{d}f=E_s&lt;\infty
$$&lt;p&gt;
其中， $E_s$ 为码元的平均能量。&lt;/p&gt;
&lt;p&gt;由上式可知，在 $t=t_0$ 时的信噪比的最大值为 $\displaystyle \frac{2E_s}{N_0}$ ，而由Cauchy-Schwartz不等式的取等条件，信噪比取得该最大值的条件是：
&lt;/p&gt;
$$
H(f)=K\cdot\left(S(f)\mathrm{e}^{2\pi ft_0}\right)^*=K\cdot S^*(f)\mathrm{e}^{-2\pi ft_0},~K\in\mathbb{R}
$$&lt;p&gt;
等式两边进行&lt;strong&gt;Fourier逆变换&lt;/strong&gt;，进而有：
&lt;/p&gt;
$$
h(t)=K\cdot\mathscr{F}^{-1}\{S^*(f)\mathrm{e}^{-2\pi ft_0}\}=K\cdot s(t_0-t)
$$&lt;p&gt;
上式表明，若使在 $t=t_0$ 时刻抽样第一个码元所获样本的信噪比取最大值，则 $h(t)$ 应当满足： $h(t)=K\cdot s(t_0-t)$ 。&lt;/p&gt;
&lt;p&gt;以下，我们对抽样时刻 $t_0$ 是否有特殊的要求呢？首先，由于抽样的是第一个码元，则 $t_0\in[0,~T_s]$ ；其次，若使 $h(t)$ 在实际中是可实现的，则 $h(t)$ 至少要是&lt;strong&gt;因果的&lt;/strong&gt;，即：
&lt;/p&gt;
$$
s(t_0-t)\equiv0,~\forall t&lt;0~(\Leftrightarrow\forall t_0-t&gt;t_0)
$$&lt;p&gt;
注意到 $s(t)$ 在 $[0,~T_s]$ 上是非0的，则有 $t_0\geqslant T_s$ ，因此，对抽样时刻的最优选择只能是 $t=T_s$ ，对应的匹配滤波器的单位脉冲响应为 $h(t)=s(T_s-t)$ （为方便讨论，不妨约定 $K=1$ ）。&lt;/p&gt;
&lt;p&gt;以下，我们考查更一般的情形，假定输入信号为：
&lt;/p&gt;
$$
z(t)=s(t)+n(t)=\sum\limits_{k=1}^{+\infty}s_k(t)+n(t)
$$&lt;p&gt;
其中， $s_k(t)$ 为第 $k$ 个码元的对应波形，则我们不妨将其设为 $s_k(t)=a_k\hat{s}(t-(k-1)T_s)$ ，$a_k$ 为随机二进制序列在第 $k$ 位取值的随机变量，$\hat{s}(t)$ 是仅在 $[0,~T]$ 非0的脉冲波形。将该输入信号输入匹配滤波器后，我们有：
&lt;/p&gt;
$$
y(t)=z(t)*h(t)=\sum\limits_{k=1}^{+\infty}s_k(t)*h(t)+n(t)*h(t)=\sum\limits_{k=1}^{+\infty}y_{s,k}(t)+y_n(t)
$$&lt;p&gt;
不难发现，此时的输出脉冲波形是AWGN噪声对应响应 $y_n(t)$ 与各码元对应响应 $y_{s,k}(t)$ 的线性叠加，如果我们在 $t=kT_s$ 时刻对第 $k$ 个码元进行抽样，则很明显，我们希望在该时刻&lt;strong&gt;有且仅有&lt;/strong&gt;第 $k$ 个码元对应响应与AWGN噪声对应响应的叠加（否则不同码元响应的叠加会导致干扰），即：
&lt;/p&gt;
$$
y(kT_s)=y_{s,k}(kT_s)+y_n(kT_s),~k\in\mathbb{N}_+
$$&lt;p&gt;
这直接导致 $y_{s,k}(t)$ 必须在时域上有限，更具体地说， $y_{s,k}(t)$​ 至多在 $(k-1)T_s&amp;lt;t&amp;lt;(k+1)T_s$ 时非0，结合 $y_{s,k}(t)$ 的表达式：
&lt;/p&gt;
$$
y_{s,k}(t)=\int_{-\infty}^{+\infty}s_k(\tau)h(t-\tau)\mathrm{d}\tau=\int_{(k-1)T_s}^{kT_s}s_k(\tau)h(t-\tau)\mathrm{d}\tau,~t-\tau\in(t-kT_s,~t-(k-1)T_s)
$$&lt;p&gt;
可知 $h(t)$ 也必须在时域上有限，至多在 $0 &amp;lt; t &amp;lt; T_s$ 上非0（此处同时考虑了 $h(t)$ 的&lt;strong&gt;因果性&lt;/strong&gt;）。进而我们有：
&lt;/p&gt;
$$
\text{SNR}(kT_s)=\frac{\displaystyle\left|\int_{-\infty}^{+\infty}s(\tau)h(kT_s-\tau)\mathrm{d}\tau\right|^2}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}h^2(kT_s-\tau)\mathrm{d}\tau}=\frac{\displaystyle\left|\int_{(k-1)T_s}^{kT_s}a_k\hat{s}(\tau-(k-1)T_s)h(kT_s-\tau)\mathrm{d}\tau\right|^2}{\displaystyle \frac{N_0}{2}\int_{-\infty}^{+\infty}h^2(kT_s-\tau)\mathrm{d}\tau}\leqslant\frac{2E_s}{N_0}
$$&lt;p&gt;
此时不等式的取等条件为：
&lt;/p&gt;
$$
h(kT_s-\tau)=K\cdot a_k\hat{s}(\tau-(k-1)T_s)~\Leftrightarrow~h(t)=K\cdot a_k\hat{s}(T_s-t),~K\in\mathbb{R}
$$&lt;p&gt;
综上可知，对形如 $\displaystyle z(t)=\sum\limits_{k=1}^{+\infty}a_k\hat{s}(t-(k-1)T_s)+n(t)$ 的接收信号，我们仅需保证匹配滤波器的单位脉冲响应 $h(t)=\hat{s}(T_s-t)$ ，即可同时使在 $t=kT_s$ 时刻对第 $k$ 个码元的抽样信噪比达到最大。&lt;/p&gt;
&lt;h3 id=&#34;使用相关运算取代匹配滤波器&#34;&gt;使用相关运算取代匹配滤波器
&lt;/h3&gt;&lt;p&gt;匹配滤波器虽然可以使抽样时的信噪比达到最大，但是相对而言难以实现，为此，我们有时会使用相关运算取代匹配滤波器的实现，我们仅需注意到，当 $t=kT_s$ 时，成立：
&lt;/p&gt;
$$
y(kT_s)=\int_{(k-1)T_s}^{kT_s}z(\tau)\hat{s}(\tau-(k-1)T_s)\mathrm{d}\tau=\int_{0}^{T_s}z(\tau+(k-1)T_s)\hat{s}(\tau)\mathrm{d}\tau
$$&lt;p&gt;
我们如果定义信号 $f(t)$ 与 $g(t)$ 的&lt;strong&gt;相关运算&lt;/strong&gt;为：
&lt;/p&gt;
$$
(f\otimes g)(t)=\int_{-\infty}^{+\infty}f^*(\tau)g(\tau+t)\mathrm{d}\tau
$$&lt;p&gt;
则考虑到 $z(t),~\hat{s}(t)$ 均为&lt;strong&gt;实信号&lt;/strong&gt;，易有：
&lt;/p&gt;
$$
y(kT_s)=(\hat{s}\otimes z)((k-1)T_s)
$$&lt;p&gt;
我们不难注意到， $y(kT_s)=(\hat{s}\otimes z)((k-1)T_s)$ 是在 $t=kT_s$ 信噪比最大的输出信号（之一），这一结论对&lt;strong&gt;任意形式&lt;/strong&gt;的匹配滤波器均成立，那么，我们不妨构造系统 $\mathscr{H}$ ，满足：&lt;/p&gt;
$$
y(t)=\mathscr{H}\{x(t)\}=(\hat{s}\otimes x)(t-T_s)=\int_{0}^{T_s}\hat{s}(\tau)x(\tau+t-T_s)\mathrm{d}\tau
$$&lt;p&gt;
这样，该系统在 $t=kT_s$ 时的信噪比也能够达到最大。&lt;/p&gt;
&lt;p&gt;这样的系统 $\mathscr{H}$ 相比原来的匹配滤波器设计有什么好处呢？除相关运算更易于实现外，该系统实际上可以对更广义的脉冲波形进行处理，如果我们记：
&lt;/p&gt;
$$
s_n(t)=\left\{\begin{array}{lcl}
s_{(1)}(t-nT_s)&amp;&amp;\text{for a binary 1, with probability of}~p\\
\\
s_{(0)}(t-nT_s)&amp;&amp;\text{for a binary 0, with probability of}~1-p\\
\end{array}\right.
$$&lt;p&gt;
且 $s_{(1)}(t)$ 与 $s_{(0)}(t)$ 如果不具备&lt;strong&gt;倍数关系&lt;/strong&gt;的话，则原来的匹配滤波器失效（因为 $h(t)$ 显然不可能在 $s_{(1)}(T_s-t)$ 与 $s_{(0)}(T_s-t)$ 间概率性地切换），但我们仍然可以使用系统 $\mathscr{H}$ 进行设计，可以分别构造如下两个系统：
&lt;/p&gt;
$$
y(t)=\mathscr{H}_{(0)}\{x(t)\}=(s_{(0)}\otimes x)(t-T_s),~y(t)=\mathscr{H}_{(1)}\{x(t)\}=(s_{(1)}\otimes x)(t-T_s)
$$&lt;p&gt;
则我们可以分别将接收信号 $z(t)$ 输入两个系统得到输出 $y_{(0)}(t)$ 与 $y_{(1)}(t)$ ，再根据 $y_{(0)}(t)$ 与 $y_{(1)}(t)$ 在 $t=kT_s$ 的取值判断第 $k$ 个码元的取值。&lt;/p&gt;
&lt;p&gt;至于具体如何依据 $y_{(0)}(kT_s)$ 与 $y_{(1)}(kT_s)$ 的取值判断第 $k$ 个码元的取值，我们可举一个简单的例子，如果我们&lt;strong&gt;忽略噪声&lt;/strong&gt;并认为：
&lt;/p&gt;
$$
\int_{0}^{T_s}s_{(0)}^2(\tau)\mathrm{d}\tau=\int_{0}^{T_s}s_{(1)}^2(\tau)\mathrm{d}\tau=E_s
$$&lt;p&gt;
则依据&lt;strong&gt;Cauchy-Schwartz不等式&lt;/strong&gt;，我们有：
&lt;/p&gt;
$$
E_s\geqslant\int_{0}^{T_s}s_{(0)}(\tau)s_{(1)}(\tau)\mathrm{d}\tau
$$&lt;p&gt;
因此，我们可得如下判定条件：当 $y_{(1)}(kT_s)&amp;gt;y_{(0)}(kT_s)$ 时，则第 $k$ 个码元为&lt;strong&gt;1&lt;/strong&gt;；当 $y_{(1)}(kT_s)&amp;lt;y_{(0)}(kT_s)$ 时，则第 $k$ 个码元为&lt;strong&gt;0&lt;/strong&gt;。&lt;/p&gt;
&lt;h2 id=&#34;awgn噪声干扰下的二进制信号检测&#34;&gt;AWGN噪声干扰下的二进制信号检测
&lt;/h2&gt;&lt;h3 id=&#34;一般性模型&#34;&gt;一般性模型
&lt;/h3&gt;&lt;p&gt;在本节，我们将通过对更一般情形的分析，讨论如何对AWGN噪声干扰下的接收波形进行接收滤波以及抽样判决，在上节中我们已经讨论过，使用怎样的接收滤波器才可以满足&lt;strong&gt;最大输出信噪比准则&lt;/strong&gt;，而在本节我们主要讨论，应当使用怎样的策略对通过接收滤波器的信号进行抽样判决，才能使得判决的结果满足&lt;strong&gt;最小错误概率准则&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;为此，首先我们定义更为一般的接收信号，假设对一个码元而言，共有 $M$ 种可能的脉冲波形，构成集合：
&lt;/p&gt;
$$
S_M=\{s_m(t)|m=1,~2,\cdots,~M\}
$$&lt;p&gt;
而此处我们默认 $S_M$ 满足一个性质：即 $S_M$ 中的脉冲波形可进行&lt;strong&gt;正交基分解&lt;/strong&gt;，换言之，存在一组正交基：
&lt;/p&gt;
$$
F_N=\{f_n(t)|n=1,~2,\cdots,~n\},~\int_{-\infty}^{+\infty}f_n(t)f_m(t)\mathrm{d}t=\delta_{mn}
$$&lt;p&gt;
使得：
&lt;/p&gt;
$$
s_m(t)=\sum\limits_{n=1}^{N}\hat{s}_{mn}f_n(t),~m=1,~2,\cdots,~M
$$&lt;p&gt;
或可写成矩阵形式：
&lt;/p&gt;
$$
\left[\begin{array}{c}
s_1(t)\\
s_2(t)\\
\vdots\\
s_M(t)
\end{array}\right]=\left[\begin{array}{cccc}
\hat{s}_{11}&amp;\hat{s}_{12}&amp;\cdots&amp;\hat{s}_{1N}\\
\hat{s}_{21}&amp;\hat{s}_{22}&amp;\cdots&amp;\hat{s}_{2N}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
\hat{s}_{M1}&amp;\hat{s}_{M2}&amp;\cdots&amp;\hat{s}_{MN}
\end{array}\right]\left[\begin{array}{c}
f_1(t)\\
f_2(t)\\
\vdots\\
f_N(t)
\end{array}\right]
$$&lt;p&gt;
进而，接收信号 $z(t)$ 便可记作：
&lt;/p&gt;
$$
z(t)=s_m(t)+n(t)=\sum\limits_{k=1}^{N}\hat{s}_{mk}f_k(t)+n(t)
$$&lt;p&gt;
其次，我们设计如下的接收滤波器：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-7.png&#34;
	width=&#34;688&#34;
	height=&#34;673&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-7_hu_d359ac1acb6ae865.png 480w, https://posvirus.github.io/p/dic-006/Lec2-7_hu_5175587a6e4c2779.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;接收滤波器的设计&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;102&#34;
		data-flex-basis=&#34;245px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;读图可知，该接收滤波器有 $N$ 个并行的相关器，分别输出 $z(t)$ 与 $N$ 个基函数的相关性，而我们最终即基于这 $N$ 条描述相关性的抽样信息，去判定接收的波形究竟是 $S_M$ 中的哪一者。如果用数学语言描述，即为：
&lt;/p&gt;
$$
r_k=\int_{0}^{T_s}f_k(t)z(t)\mathrm{d}t=\int_{0}^{T_s}f_k(t)\cdot\sum\limits_{j=1}^N\hat{s}_{mj}f_j(t)\mathrm{d}t+\int_{0}^{T_s}f_k(t)n(t)\mathrm{d}t
$$&lt;p&gt;
利用正交基的性质，并记 $\displaystyle n_k=\int_{0}^{T_s}f_k(t)n(t)\mathrm{d}t$ ，则有：
&lt;/p&gt;
$$
r_k=\hat{s}_{mk}+n_k,~m=1,~2,\cdots,~M
$$&lt;p&gt;
我们最终即需根据输出的抽样向量 $\vec{r}=[r_1,~r_2,\cdots,~r_N]^T$ ，判定接收信号 $z(t)$ 中所传输的脉冲波形 $s_m(t)$ 。&lt;/p&gt;
&lt;p&gt;以下，我们考查抽样向量所满足的性质，对 $r_k$ 而言， $\hat{s}_{mk}$ 是一个确定值，而 $n_k$ 则是一个服从&lt;strong&gt;正态分布&lt;/strong&gt;的随机变量，且由积分运算的线性性质，其均值 $E[n_k]$ 满足：
&lt;/p&gt;
$$
E[n_k]=E\left[\int_{0}^{T_s}f_k(t)n(t)\mathrm{d}t\right]=\int_{0}^{T_s}f_k(t)E[n(t)]\mathrm{d}t=0
$$&lt;p&gt;
其方差 $D[n_k]$ 满足：
&lt;/p&gt;
$$
D[n_k]=E[n_k^2]-(E[n_k])^2=E[n_k^2]
$$&lt;p&gt;
而由上节的推导可知，若 $n(t)$ 的&lt;strong&gt;功率谱&lt;/strong&gt;为 $\displaystyle \frac{N_0}{2}$ ，则有：
&lt;/p&gt;
$$
D[n_k]=E[n_k^2]=\frac{N_0}{2}\int_{0}^{T_s}f^2_k(t)\mathrm{d}t=\frac{N_0}{2}
$$&lt;p&gt;
因此有：
&lt;/p&gt;
$$
n_k\sim N\left(0,~\frac{N_0}{2}\right)~\Rightarrow~r_k\sim N\left(\hat{s}_{mk},~\frac{N_0}{2}\right)
$$&lt;p&gt;
以上的推导实质上是在&lt;strong&gt;已知传输的脉冲波形为$s_m(t)$​&lt;/strong&gt; 的前提下进行的。因此，可以知道，如果接收信号传输的脉冲波形为 $s_m(t)$ （将该事件简记为 $s_m$ ），则输出向量 $\vec{r}$ 满足的&lt;strong&gt;概率密度函数&lt;/strong&gt;为：
&lt;/p&gt;
$$
\rho(\vec{r}|s_m)=\prod\limits_{k=1}^N\rho(r_k|s_m)=\frac{1}{(\sqrt{\pi N_0})^N}\cdot\exp\left(-\frac{\displaystyle\sum\limits_{k=1}^N(r_k-\hat{s}_{mk})^2}{N_0}\right)
$$&lt;p&gt;
那么，不难注意到，如果我们得到的抽样向量为 $\vec{r}$ ，则若要使得判决结果 $s(t)$ 满足&lt;strong&gt;最小错误概率准则&lt;/strong&gt;，应进行如下判决：
&lt;/p&gt;
$$
s(t)=\underset{s_m(t)\in S_M}{\text{argmax}}\{\rho(s_m|\vec{r})\}
$$&lt;p&gt;
其中， $\text{argmax}$ 代表能够使目标函数取得最大值的&lt;strong&gt;自变量&lt;/strong&gt;集合，上述判决准则的含义是：在已知抽样向量 $\vec{r}$ 的条件下，如果取得某个脉冲波形 $s_m(t)$ 的&lt;strong&gt;条件概率&lt;/strong&gt;最大，则就认为接收波形传输的是 $s_m(t)$ 。从概率论的角度， $\rho(s_m|\vec{r})$ 是&lt;strong&gt;后验概率&lt;/strong&gt;，因此这种判决准则又被称为&lt;strong&gt;最大后验概率准则（Maximum A Posteriori Estimation, MAP）&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;利用最大后验概率准则，我们可以使判决完全满足最小错误概率准则。但是，最大后验概率准则是可实现的吗？这一问题实质上等价于在已知抽样向量 $\vec{r}$ 时，后验概率密度 $\rho(s_m|\vec{r})$ 是否是可算的。为此，我们可以使用&lt;strong&gt;Bayes公式&lt;/strong&gt;，将后验概率 $\rho(s_m|\vec{r})$ 转化为先验概率 $\rho(\vec{r}|s_m)$ ：
&lt;/p&gt;
$$
\rho(s_m|\vec{r})=\frac{\displaystyle \rho(\vec{r}|s_m)\cdot\rho(s_m)}{\displaystyle\rho(\vec{r})}=\frac{\displaystyle \rho(\vec{r}|s_m)\cdot\rho(s_m)}{\displaystyle\sum\limits_{m=1}^M\rho(\vec{r}|s_m)\cdot\rho(s_m)}
$$&lt;p&gt;由上式可知，由于 $\rho(\vec{r}|s_m)$ 是已知的，如果希望计算 $\rho(s_m|\vec{r})$ ，则必须需要知道 $\rho(s_m)$ ，即各脉冲波形在序列中出现的概率，但很显然，对接收系统而言，我们无法事先预判各脉冲波形出现的概率，因此， $\rho(s_m)$ 是未知的，进而导致 $\rho(s_m|\vec{r})$ 不可算，基于最大后验概率准则的抽样判决实质上是&lt;strong&gt;不可实现的&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;但是，最大后验概率准则并非一无是处，虽然我们无法知道确切的 $\rho(s_m)$ ，但我们可以作一个先验的假设，认为任一脉冲波形的出现均是&lt;strong&gt;等概率的&lt;/strong&gt;（即 $\rho(s_m)=1/M,~m=1,~2,\cdots,~M$ ），则我们有：
&lt;/p&gt;
$$
\rho(s_m|\vec{r})=\frac{\rho(\vec{r}|s_m)}{\displaystyle\sum\limits_{k=1}^M\rho(\vec{r}|s_k)}
$$&lt;p&gt;
注意到， $\displaystyle\sum\limits_{k=1}^M\rho(\vec{r}|s_k)$ 对固定的 $\vec{r}$ 而言是一个常量，则最大后验概率准则对应的判决表达式可等价为：
&lt;/p&gt;
$$
s(t)=\underset{s_m(t)\in S_M}{\text{argmax}}\left\{\rho(\vec{r}|s_m)\right\}
$$&lt;p&gt;
这一判决准则又被称为&lt;strong&gt;最大似然概率准则（Maximum Likelihood Estimation, ML）&lt;/strong&gt;，考虑到前文已给出的 $\rho(\vec{r}|s_m)$ 的表达式，该准则可进一步等价为（利用 $\mathrm{e}^{-x}$ 的单调性）：
&lt;/p&gt;
$$
s(t)=\underset{s_m(t)\in S_M}{\text{argmin}}\{\Vert\vec{r}-\hat{s}_{m}\Vert^2\},~\hat{s}_m=[\hat{s}_{m1},~\hat{s}_{m2},\cdots,~\hat{s}_{mN}]^T
$$&lt;p&gt;
直观上，最大似然概率准则即是在得到抽样向量 $\vec{r}$ 后，直接比较 $\vec{r}$ 与各个 $\hat{s}_m$ 系数的&lt;strong&gt;平方误差&lt;/strong&gt;，认为其中的最小者即为传输的脉冲波形。&lt;/p&gt;
&lt;h3 id=&#34;一类特殊情形&#34;&gt;一类特殊情形
&lt;/h3&gt;&lt;p&gt;以下，我们考查在前文中提到的一类特殊情形，此时的脉冲波形只有两种 $s_{(1)}(t),~s_{(0)}(t)$ ，分别代表&lt;strong&gt;二进制1&lt;/strong&gt;与&lt;strong&gt;二进制0&lt;/strong&gt;，且我们可以使用一个基函数 $s(t)$ 对其进行展开：
&lt;/p&gt;
$$
s_{(i)}(t)=a_{(i)}\cdot s(t),~i=0,~1
$$&lt;p&gt;
那么，此时的接收滤波器便可以仅由一个相关器 $\mathscr{H}$ 构成（ $\displaystyle y(t)=\mathscr{H}{x(t)}=\int_{0}^{T_s}s(\tau)x(\tau+t-T_s)\mathrm{d}\tau$ ），当传输脉冲波形为 $s_{(i)}(t)$ 时，对应相关器输出 $r$ &lt;sup id=&#34;fnref:7&#34;&gt;&lt;a href=&#34;#fn:7&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;7&lt;/a&gt;&lt;/sup&gt;为：
&lt;/p&gt;
$$
r=a_{(i)}+n_i,~i=0,~1
$$&lt;p&gt;则若依据&lt;strong&gt;最大后验概率准则&lt;/strong&gt;，此时的判定准则为：
&lt;/p&gt;
$$
\rho(r|s_{(1)})\cdot\rho(s_{(1)})\lesseqqgtr\rho(r|s_{(0)})\cdot\rho(s_{(0)})
$$&lt;p&gt;
进一步等价于：
&lt;/p&gt;
$$
\exp\left(-\frac{(r-a_{(1)})^2}{N_0}\right)\cdot\rho(s_{(1)})\lesseqqgtr\exp\left(-\frac{(r-a_{(0)})^2}{N_0}\right)\cdot\rho(s_{(0)})
$$&lt;p&gt;
此亦即：
&lt;/p&gt;
$$
\exp\left(\frac{(a_{(1)}-a_{(0)})(2r-a_{(0)}-a_{(1)})}{N_0}\right)=\exp\left(\frac{(r-a_{(0)})^2-(r-a_{(1)})^2}{N_0}\right)\lesseqqgtr\frac{\rho(s_{(0)})}{\rho(s_{(1)})}
$$&lt;p&gt;
如果考查&lt;strong&gt;正逻辑&lt;/strong&gt;（即 $a_{(1)}&amp;gt;a_{(0)}$ ），化简即有：
&lt;/p&gt;
$$
r\lesseqqgtr\frac{a_{(0)}+a_{(1)}}{2}-\frac{N_0}{2}\cdot\frac{\ln(\rho(s_{(1)}))-\ln(\rho(s_{(0)}))}{a_{(1)}-a_{(0)}}
$$&lt;p&gt;
由此可知，&lt;strong&gt;判决门限&lt;/strong&gt; $\gamma$ 满足：
&lt;/p&gt;
$$
\gamma=\frac{a_{(0)}+a_{(1)}}{2}-\frac{N_0}{2}\cdot\frac{\ln(\rho(s_{(1)}))-\ln(\rho(s_{(0)}))}{a_{(1)}-a_{(0)}}
$$&lt;p&gt;
当 $r&amp;gt;\gamma$ 时，将接收信号判定为&lt;strong&gt;二进制1&lt;/strong&gt;；当 $r&amp;lt;\gamma$ 时，将接收信号判定为&lt;strong&gt;二进制0&lt;/strong&gt;。而若依据&lt;strong&gt;最大似然概率准则&lt;/strong&gt;，则判决门限退化为：
&lt;/p&gt;
$$
\gamma=\frac{a_{(0)}+a_{(1)}}{2}
$$&lt;h2 id=&#34;码间串扰isi&#34;&gt;码间串扰（ISI）
&lt;/h2&gt;&lt;h3 id=&#34;码间串扰的基本概念&#34;&gt;码间串扰的基本概念
&lt;/h3&gt;&lt;p&gt;在前文中我们提到过，为保证我们用于传输波形的脉冲 $s(t)$ 为基带信号，我们需要在传输前对其进行&lt;strong&gt;脉冲/基带成型&lt;/strong&gt;，即使用&lt;strong&gt;低通滤波器&lt;/strong&gt;迫使其频谱仅在&lt;strong&gt;低频有限域&lt;/strong&gt;内非0。而我们忽略了这一操作对时域脉冲波形的影响，即&lt;strong&gt;一个频域有限的信号在时域上通常是无限的&lt;/strong&gt;。换言之，对进行脉冲/基带成型后的脉冲波形 $\displaystyle s(t)=\sum\limits_{n=-\infty}^{+\infty}s_n(t)$ 而言， $s_n(t)$ 在时域上是&lt;strong&gt;无限&lt;/strong&gt;的，因此，不同码元对应的脉冲波形便会相互重叠，发生干扰，这一现象便称为 &lt;strong&gt;码间串扰（Inter-Symbol Interference, ISI）&lt;/strong&gt; ，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-8.png&#34;
	width=&#34;773&#34;
	height=&#34;364&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-8_hu_ee9f200d9608d022.png 480w, https://posvirus.github.io/p/dic-006/Lec2-8_hu_74f98871c28c8909.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;码间串扰的原理示意图&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;212&#34;
		data-flex-basis=&#34;509px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;那么，如何从数学上定量描述码间串扰呢？需要指出，对数字基带传输系统而言，我们其实仅关注码间串扰对最终&lt;strong&gt;抽样判决&lt;/strong&gt;的影响，因此，我们可以将数字基带传输系统抽样判决前的所有部分抽样为一个子系统 $\mathscr{H}$ ，对输入信号 $s(t)$ 的单位脉冲响应为 $h(t)$ 。同时，AWGN噪声 $n(t)$ 是在传输时加入的，由于其具有&lt;strong&gt;加性&lt;/strong&gt;，因此可与 $s(t)$ 相对独立地进行分析，我们可直接记噪声通过&lt;strong&gt;接收滤波器&lt;/strong&gt;后的输出为 $n_r(t)$ ，则需进行抽样判决的信号 $y(t)$ 为：
&lt;/p&gt;
$$
y(t)=\mathscr{H}\{s(t)\}+n_r(t)=s(t)*h(t)+n_r(t)
$$&lt;p&gt;
代入 $\displaystyle s(t)=\sum\limits_{n=-\infty}^{+\infty}s_n(t)$ ，有：
&lt;/p&gt;
$$
y(t)=\sum\limits_{n=-\infty}^{+\infty}\left(\int_{-\infty}^{+\infty}s_n(\tau)h(t-\tau)\mathrm{d}\tau\right)+n_r(t)
$$&lt;p&gt;
我们考虑 $s_n(t)=a_n\cdot \hat{s}(t-nT_s)$ 的特殊情形，则有：
&lt;/p&gt;
$$
y(t)=\sum\limits_{n=-\infty}^{+\infty}\left(a_n\cdot\int_{-\infty}^{+\infty}\hat{s}(\tau-nT_s)h(t-\tau)\mathrm{d}\tau\right)+n_r(t)
$$&lt;p&gt;
于是，在 $t=kT_s$ 处抽样时，对应的抽样值 $y(kT_s)$ 可化作：
&lt;/p&gt;
$$
y(kT_s)=a_k\cdot\left(\int_{-\infty}^{+\infty}\hat{s}(\tau-kT_s)h(kT_s-\tau)\mathrm{d}\tau\right)+\sum\limits_{n\ne k}\left(a_n\cdot\int_{-\infty}^{+\infty}\hat{s}(\tau-nT_s)h(kT_s-\tau)\mathrm{d}\tau\right)+n_r(kT_s)
$$&lt;p&gt;
我们可以不妨设 $\hat{s}(t)=\delta(t)$ &lt;sup id=&#34;fnref:8&#34;&gt;&lt;a href=&#34;#fn:8&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;8&lt;/a&gt;&lt;/sup&gt; ，则上式可化简为：
&lt;/p&gt;
$$
y(kT_s)=a_k\cdot h(0)+\sum\limits_{n\ne k}a_n\cdot h((k-n)T_s)+n_r(kT_s)
$$&lt;p&gt;
其中， $a_k\cdot h(0)$ 为第 $k$ 个码元对应的样本， $\displaystyle \sum\limits_{n\ne k}a_n\cdot h((k-n)T_s)$ 为码间串扰， $n_r(kT_s)$ 为AWGN噪声。&lt;/p&gt;
&lt;h3 id=&#34;使用均衡滤波器消除码间串扰&#34;&gt;使用均衡滤波器消除码间串扰
&lt;/h3&gt;&lt;p&gt;前文提及，我们可以使用&lt;strong&gt;均衡滤波器&lt;/strong&gt;消除码间串扰，本节我们便来考虑均衡滤波器的具体实现。&lt;/p&gt;
&lt;p&gt;我们记均衡滤波器为系统 $\mathscr{B}$ ，均衡滤波器的输入信号为 $y(t)$ ：
&lt;/p&gt;
$$
y(t)=\sum\limits_{n=-\infty}^{+\infty}a_n\cdot h(t-nT_s)+n_r(t)
$$&lt;p&gt;
同时设均衡滤波器的输出信号： $z(t)=\mathscr{B}\{y(t)\}$ ，则不妨假定这是一个&lt;strong&gt;线性非时变系统&lt;/strong&gt;，我们有：
&lt;/p&gt;
$$
z(t)=\sum\limits_{n=-\infty}^{+\infty}a_n\cdot\mathscr{B}\{h(t-nT_s)\}+\mathscr{B}\{n_r(t)\}
$$&lt;p&gt;
为方便说明，不妨记 $h_o(t)=\mathscr{B}\{h(t)\},~n_o(t)=\mathscr{B}\{n_r(t)\}$​ ，则利用系统的&lt;strong&gt;非时变性&lt;/strong&gt;，有：
&lt;/p&gt;
$$
z(t)=\sum\limits_{n=-\infty}^{+\infty}a_n\cdot h_o(t-nT_s)+n_o(t)
$$&lt;p&gt;
对均衡滤波器，要使其能够消除码间串扰，我们至少希望&lt;strong&gt;输出信号在抽样时刻对应的码间串扰为0&lt;/strong&gt;，而&lt;strong&gt;样本&lt;/strong&gt;不为0，考虑 $t=kT_s$ 时刻的抽样，即：
&lt;/p&gt;
$$
a_k\cdot h_o(0)\ne0,~\sum\limits_{n\ne k}a_n\cdot h_o((k-n)T_s)=0,~\forall k\in \mathbb{Z}
$$&lt;p&gt;
如果我们进一步&lt;strong&gt;加强条件&lt;/strong&gt;，我们其实可以要求 $h_o(t)$ 满足：
&lt;/p&gt;
$$
\mathscr{B}\{h(t)\}=h_o(t)=\left\{\begin{array}{lcl}
1&amp;&amp;t=0\\
\\
0&amp;&amp;t=kT_s,~\forall k\in \mathbb{Z}/\{0\}\\
\end{array}\right.
$$&lt;p&gt;
要实现这一点，其实我们仅需记系统 $\mathscr{B}$ 的单位脉冲响应为 $\displaystyle b(t)=\sum_{n=-\infty}^{+\infty}b_k\cdot\delta(t-kT_s)$ ，则易有：
&lt;/p&gt;
$$
h_o(t)=\int_{-\infty}^{+\infty}b(\tau)h(t-\tau)\mathrm{d}\tau=\sum\limits_{n=-\infty}^{+\infty}b_n\cdot h(t-nT_s)
$$&lt;p&gt;
因此，我们仅需确定系数 $b_k,~k\in\mathbb{Z}$ ，使得 $h_o(t)$ 满足性质即可。同时，我们注意，此时的系统 $\mathscr{B}$ 对应&lt;strong&gt;递归方程&lt;/strong&gt;：
&lt;/p&gt;
$$
y(t)=\mathscr{B}\{x(t)\}=\sum\limits_{n=-\infty}^{+\infty}b_n\cdot x(t-nT_s)
$$&lt;p&gt;
一方面，这一系统是&lt;strong&gt;非因果的&lt;/strong&gt;，同时涉及&lt;strong&gt;无限多个&lt;/strong&gt;延时器，因此是&lt;strong&gt;物理不可实现的&lt;/strong&gt;，为获得一个物理可实现的均衡滤波器，我们考查如下系统：
&lt;/p&gt;
$$
y(t)=\mathscr{B}\{x(t)\}=\sum\limits_{n=0}^{N}b_n\cdot x(t-nT_s),~b(t)=\sum\limits_{n=0}^{N}b_n\cdot\delta(t-nT_s)
$$&lt;p&gt;
上述系统即是将系统响应的无穷求和变为了有限项求和，此时输出 $\displaystyle h_o(t)=\sum\limits_{n=0}^{N}b_n\cdot h(t-nT_s)$ ，为方便讨论，我们记 $c_k=h(kT_s)$ ，则有：
&lt;/p&gt;
$$
h_o(kT_s)=\sum\limits_{n=0}^{N}b_n\cdot c_{k-n}
$$&lt;p&gt;
首先注意两个事实：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$h(t)$ 是&lt;strong&gt;因果系统&lt;/strong&gt;的单位脉冲响应，因此对所有的$k&amp;lt;0$，有 $c_k=0$ ，进而 $h_o(kT_s)=0$ （这也可以理解为因果系统级联仍为因果系统）。&lt;/li&gt;
&lt;li&gt;$h_o(t)$ 在 $t$ 充分大时通常近似为0。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因此，我们对 $h_o(t)$ 的要求其实可以弱化为：
&lt;/p&gt;
$$
\mathscr{B}\{h(t)\}=h_o(t)=\left\{\begin{array}{lcl}
1&amp;&amp;t=0\\
\\
0&amp;&amp;t=kT_s,~1\leqslant k\leqslant N\\
\end{array}\right.
$$&lt;p&gt;
其中，保证 $N$ 为一充分大的正整数即可，换言之，对码元 $a_n\cdot h_o(t-nT_s)$ ，我们仅需考虑其对&lt;strong&gt;未来&lt;/strong&gt; $N$ 个码元（对过去的码元无影响）的码间串扰，之后的码间串扰即使不作处理也可忽略不计。&lt;/p&gt;
&lt;p&gt;进而，我们仅需确定 $N+1$ 个未知数 $b_k,~0\leqslant k\leqslant N+1$ 的取值，其应满足线性方程组：
&lt;/p&gt;
$$
\left[\begin{array}{cccc}
c_0&amp;c_{-1}&amp;\cdots&amp;c_{-N}\\
c_1&amp;c_0&amp;\cdots&amp;c_{1-N}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
c_N&amp;c_{N-1}&amp;\cdots&amp;c_{0}
\end{array}\right]\left[\begin{array}{c}
b_0\\
b_1\\
\vdots\\
b_N
\end{array}\right]=\left[\begin{array}{c}
1\\
0\\
\vdots\\
0
\end{array}\right]
$$&lt;p&gt;
这种均衡滤波器设计一般称为&lt;strong&gt;迫零均衡器&lt;/strong&gt;，其实现如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-006/Lec2-9.png&#34;
	width=&#34;802&#34;
	height=&#34;326&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-006/Lec2-9_hu_8bacbc16ae8106c5.png 480w, https://posvirus.github.io/p/dic-006/Lec2-9_hu_5142ad0342d8e79f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;迫零均衡器的设计&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;246&#34;
		data-flex-basis=&#34;590px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;其中， $N$ 一般称为迫零均衡器的&lt;strong&gt;抽头数&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;均衡滤波器的性能评估&#34;&gt;均衡滤波器的性能评估
&lt;/h3&gt;&lt;p&gt;以下，我们可给出用于评估均衡滤波器的性能指标，记均衡滤波器 $\mathscr{B}$ 前子系统的单位脉冲响应为 $h(t)$ ，且 $h_o(t)=\mathscr{B}\{h(t)\}$ ，则有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;输出峰值失真：&lt;/strong&gt; $\displaystyle D_o=\frac{\displaystyle \sum\limits_{n\ne 0}h_o(nT_s)}{h_o(0)}$ ，即输出信号&lt;strong&gt;码间串扰&lt;/strong&gt;与&lt;strong&gt;原样本&lt;/strong&gt;的比值。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;输入峰值失真：&lt;/strong&gt; $\displaystyle D=\frac{\displaystyle \sum\limits_{n\ne 0}h(nT_s)}{h(0)}$ ，即输入信号&lt;strong&gt;码间串扰&lt;/strong&gt;与&lt;strong&gt;原样本&lt;/strong&gt;的比值。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一般地，我们使用 $\eta=D/D_o$ 来评估均衡滤波器的效果， $\eta$ 越大，均衡滤波器的效果越好。&lt;/p&gt;
&lt;p&gt;但同时注意，均衡滤波器不可避免地会对噪声信号 $n_r(t)$ 进行进一步处理，导致在 $t=kT_s$ 抽样时，信噪比可能有所降低。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;有的文本中会直接表述为“用数字序列&lt;strong&gt;调制&lt;/strong&gt;脉冲波形”，此处使用&lt;strong&gt;整合&lt;/strong&gt;一词只是为了方便理解，并区别于&lt;strong&gt;载波调制&lt;/strong&gt;过程。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;在数字通信中常常用时间间隔相同的符号来表示一个二进制数字，这样的时间间隔内的信号称为（二进制）&lt;strong&gt;码元&lt;/strong&gt;，时间间隔长度则被称为&lt;strong&gt;码元宽度&lt;/strong&gt;。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;&lt;strong&gt;传码率&lt;/strong&gt;指单位时间内传输的&lt;strong&gt;码元数&lt;/strong&gt;；&lt;strong&gt;传信率&lt;/strong&gt;指单位时间内传输的&lt;strong&gt;比特数&lt;/strong&gt;。&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref1:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;对信号 $n(t)$ ，其&lt;strong&gt;平均功率&lt;/strong&gt;定义为： $\displaystyle P=\lim\limits_{T\to+\infty}\frac{1}{T}\int_{-T/2}^{T/2}n^2(t)\mathrm{d}t$，若记 $n_T(t)$ 为 $n(t)$ 在 $[-T/2,~T/2]$ 内的表达式（其余区域内取值为0），对应的Fourier变换为 $N_T(\omega)$ ，则平均功率亦可记作 $\displaystyle P=\int_{-\infty}^{+\infty}\lim\limits_{T\to+\infty}\frac{n_T^2(t)}{T}\mathrm{d}t$ ，利用&lt;strong&gt;Parseval定理&lt;/strong&gt;，可得 $P=\displaystyle \int_{-\infty}^{+\infty}\lim\limits_{T\to+\infty}\frac{|N_T(\omega)|^2}{2\pi T}\mathrm{d}\omega$，则我们一般称 $P_s(\omega)=\displaystyle\lim\limits_{T\to+\infty}\frac{|N_T(\omega)|^2}{2\pi T}$ 为信号 $n(t)$ 对应的&lt;strong&gt;功率密度函数/功率谱&lt;/strong&gt;。同理，我们也可以定义 $n(t)$ 的&lt;strong&gt;能量密度函数/能量谱&lt;/strong&gt;为 $E_s(\omega)=\displaystyle \lim\limits_{T\to+\infty}\frac{|N_T(\omega)|^2}{2\pi}$。&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34;&gt;
&lt;p&gt;此处的&lt;strong&gt;平均功率&lt;/strong&gt;，指的是噪声信号 $n(t)$ 在某一时刻&lt;strong&gt;瞬时功率的数学期望&lt;/strong&gt;，而先前定义&lt;strong&gt;功率谱&lt;/strong&gt;时的平均功率，指的是噪声信号 $n(t)$ 在整个时域上功率的平均值。基于此，我们也可对AWGN噪声模型有一个更清晰的理解： $n(t)$ 在每个时刻的取值都服从正态分布，而所有时刻的 $n(t)$ 取值构成的噪声信号又要使得其对应的功率谱为一常数。&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:6&#34;&gt;
&lt;p&gt;其实，更一般地，对第 $k$ 个码元 $s_k(t)$ ，我们仅需认为其在 $[0,~kT_s]$ 上非0即可。↩&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:7&#34;&gt;
&lt;p&gt;此处为方便讨论，不妨设 $s(t)$ 的能量是1。&amp;#160;&lt;a href=&#34;#fnref:7&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:8&#34;&gt;
&lt;p&gt;此处可以简单解释下为何可以不妨令 $\hat{s}(t)=\delta(t)$ ，注意到 $s(t)=\displaystyle\sum\limits_{n=-\infty}^{+\infty}a_n\cdot\hat{s}(t-nT_s)=\hat{s}(t)*\left(\displaystyle\sum\limits_{n=-\infty}^{+\infty}a_n\cdot\delta(t-nT_s)\right)$ ，因此我们可以将输入信号视为 $\displaystyle\sum\limits_{n=-\infty}^{+\infty}a_n\cdot \delta(t-nT_s)$ ，再在子系统 $\mathscr{H}$ 首端级联一个单位脉冲响应为$\hat{s}(t)$ 的系统以得到 $s(t)$ 。当然，当我们设 $\hat{s}(t)=\delta(t)$ 时，子系统 $\mathscr{H}$ 的单位脉冲响应也要加入 $\hat{s}(t)$ 。&amp;#160;&lt;a href=&#34;#fnref:8&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>通信系统简介</title>
        <link>https://posvirus.github.io/p/dic-005/</link>
        <pubDate>Tue, 18 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-005/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-005/cicc.png" alt="Featured image of post 通信系统简介" /&gt;&lt;blockquote&gt;
&lt;p&gt;本文是我在几年前学习《VLSI数字信号处理系统设计》这门课程时所做的笔记，此处进行简单整理，以供复习。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;一般通信系统&#34;&gt;一般通信系统
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;通信系统的定义：&lt;/strong&gt; 通信系统是传输信息所需技术设备的总和。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;通信系统的一般模型：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-005/Lec1-1.png&#34;
	width=&#34;1002&#34;
	height=&#34;357&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-005/Lec1-1_hu_cf8d4062345d04bd.png 480w, https://posvirus.github.io/p/dic-005/Lec1-1_hu_c8d1f6c66709803.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;通信系统的一般模型&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;280&#34;
		data-flex-basis=&#34;673px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;通信系统一般由&lt;strong&gt;信息源（信源）&lt;/strong&gt;、&lt;strong&gt;发送设备&lt;/strong&gt;、&lt;strong&gt;信道&lt;/strong&gt;、&lt;strong&gt;接收设备&lt;/strong&gt;、&lt;strong&gt;受信者（信宿）&lt;/strong&gt; 构成，各成分的具体定义如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;信息源（信源）：&lt;/strong&gt; 产生或发出消息的人或机器&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;发送设备：&lt;/strong&gt; 将信源产生的消息信号变换成便于传送的形式&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;接收设备：&lt;/strong&gt; 从带有干扰的接收信号中正确恢复出原始信号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;受信者（信宿）：&lt;/strong&gt; 接收消息的人或机器&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;同时，我们可对通信系统传输的信号进行分类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;基带信号（Baseband）：&lt;/strong&gt; 信源发出的没有经过调制（进行频谱搬移和变换）的原始电信号，其特点是信号的幅度在零频附近不全为零，在其他频率幅度全为零，对一个基带信号 $f(t)$ ，其性质可用数学语言描述为：&lt;/li&gt;
&lt;/ul&gt;
$$
\exists \omega_H&gt;0,~\text{s.t.}~F(\omega)=0,~\forall \omega&gt;\omega_H,~F(\omega)=\mathscr{F}\{f(t)\}
$$&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;频带/带通信号（Bandpass）：&lt;/strong&gt; 被调制后的基带信号，又称为&lt;strong&gt;已调信号&lt;/strong&gt;，在以 $|f|=f_c$ 为中心的一个频带内幅度不全为零，其中 $f_c\gg 0$ ，叫做&lt;strong&gt;载波频率&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;载波信号（Carrier）：&lt;/strong&gt; 用于调制基带信号的载体，基带信号通过载波信号映射为带通信号，这个带通信号以某个频率 $f_c$ 为载波，这一过程通常被称为&lt;strong&gt;载波调制（Carrier modulation/demodulation）&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;注：&lt;/strong&gt; 在利用通信系统进行信号传输时，由于在近距离范围内基带信号的衰减不大，从而信号内容不会发生变化。因此在某些具有&lt;strong&gt;低通特性&lt;/strong&gt;的有线信道中，特别是传输距离不太远的情况下，&lt;strong&gt;基带信号可以不经过调制而直接进行传输&lt;/strong&gt;。如计算机内部并行总线上的信号全部都是基带信号，还有从计算机到监视器、打印机等外设的信号也都是基带传输的。在大多数的局域网直接使用基带脉冲信号传输，如以太网、令牌环网。&lt;/p&gt;
&lt;p&gt;但是，基带信号包含的低频分量不易通过无线传输，无线电磁波一般在空中传播的频率要高于&lt;strong&gt;100KHz&lt;/strong&gt;（这是因为根据 $\lambda f= c$ ，无线通信所使用的电磁波波长较短，进而具有更高的频率）。基带信号需要进行调制，与&lt;strong&gt;载波高频信号&lt;/strong&gt;混频后变换到较高的频率，然后比较容易通过天线发射（天线长度应该至少达到 $0.25\lambda\sim 0.5\lambda$ ，这也解释了为什么无线通信需要使用较短波长的电磁波，假设无线通信使用的频率为 $100~\text{KHz}$，光速默认为 $3\times10^8~\text{m/s}$ ，则可计算出电磁波波长为 $\lambda=c/f=3\times 10^3~\text{m}$ ）。因此自由空间通常传输的都是频带信号。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;通信系统的分类：&lt;/strong&gt; 通信系统根据所传信息的信号表示形式，可分为&lt;strong&gt;模拟通信系统&lt;/strong&gt;和&lt;strong&gt;数字通信系统&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;模拟通信系统：&lt;/strong&gt; 利用模拟信号传输信息的系统，一般是将采集的信号直接进行传输。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数字通信系统：&lt;/strong&gt; 利用数字信号传输信息的系统，一般是将信号转变为数字信号后再进行传输。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;模拟通信系统正在逐步被数字通信系统取代&lt;/strong&gt;，因为数字通信系统具备如下优点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;抗干扰能力强，噪声不积累&lt;/li&gt;
&lt;li&gt;易于采用纠错编码控制传输差错&lt;/li&gt;
&lt;li&gt;易于加密处理，且保密度高&lt;/li&gt;
&lt;li&gt;便于处理、变换和存储&lt;/li&gt;
&lt;li&gt;易于集成，方便小型化&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;但数字通信系统在现阶段也存在着若干不足：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;数据率高&lt;/li&gt;
&lt;li&gt;同步要求高&lt;/li&gt;
&lt;li&gt;实现复杂度高&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;虽然数字通信系统存在一些不足之处，但瑕不掩瑜，本课程的剩余部分，我们仍以数字通信系统为主体进行研究。&lt;/p&gt;
&lt;h2 id=&#34;数字通信系统&#34;&gt;数字通信系统
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;数字通信系统的一般模型：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-005/Lec1-2.png&#34;
	width=&#34;1087&#34;
	height=&#34;596&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-005/Lec1-2_hu_2924a0f6cb712413.png 480w, https://posvirus.github.io/p/dic-005/Lec1-2_hu_8e7058e259d35ce5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;数字通信系统的一般模型&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;437px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;读图可知，数字通信系统中，在&lt;strong&gt;发送设备&lt;/strong&gt;与&lt;strong&gt;接收设备&lt;/strong&gt;中分别存在着&lt;strong&gt;信道编码、信源编码&lt;/strong&gt;与&lt;strong&gt;信道译码、信源译码&lt;/strong&gt;两个过程，这是数字通信系统所独有的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;信源编码：&lt;/strong&gt; 信源编码是将信息转换成二进制数据，而后进行适当的压缩。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信源译码：&lt;/strong&gt; 信源编码的逆过程。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信道编码：&lt;/strong&gt; 信道编码是在信息传入信道前，对信息的二次编码过程，也叫&lt;strong&gt;差错控制编码&lt;/strong&gt;，就是在发送端对原数据添加冗余信息，这些冗余信息是和原数据相关的，再在接收端根据这种相关性来检测和纠正传输过程产生的差错，从而对抗传输过程的干扰。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信道译码：&lt;/strong&gt; 通过信道编码中加入的冗余信息恢复原信号的过程。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;通信系统的分类&#34;&gt;通信系统的分类
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;按通信业务分类：&lt;/strong&gt; 电话通信系统、数据通信系统、图像通信系统、多媒体通信系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;按是否调制信号分类：&lt;/strong&gt; 基带传输系统、频带传输（带通传输）系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;按传输媒质分类：&lt;/strong&gt; 有线通信系统（以&lt;strong&gt;光纤通信&lt;/strong&gt;为主）、无线通信系统（以&lt;strong&gt;无线电通信&lt;/strong&gt;为主）
&lt;ul&gt;
&lt;li&gt;对无线电通信，我们又有进一步的分类：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;按工作波段分类：&lt;/strong&gt; 长波通信、短波通信、超短波通信、微波通信等系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;按接入方式分类：&lt;/strong&gt; 频分多址、时分多址、码分多址等系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;按频带利用方式：&lt;/strong&gt; 定频窄带通信、跳频通信、扩频通信等系统&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;按消息传送的方向与时间分类：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;单工通信（Simplex）：&lt;/strong&gt; 消息只能单向传输的通信工作方式（如广播、遥控、无线寻呼等）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;半双工通信（Half Duplex）：&lt;/strong&gt; 通信双方都具备收发能力，但收发不能同时工作（如对讲机等）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;全双工通信（Full Duplex）：&lt;/strong&gt; 收发双方可同时进行双向消息传输的方式（如电话等）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>时钟分频</title>
        <link>https://posvirus.github.io/p/dic-004/</link>
        <pubDate>Tue, 11 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-004/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-004/cicc.png" alt="Featured image of post 时钟分频" /&gt;&lt;p&gt;本文主要讨论DIC中的 &lt;strong&gt;时钟分频器（Clock Divider）&lt;/strong&gt; 电路设计，它主要用于实现对输入时钟的分频处理，其模块端口声明通常如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// input clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// reset
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// output clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;cm&#34;&gt;/* internal logic */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;同时，我们不妨直接在此处给出用于时钟分频器测试的Testbench，以供参考：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// input clock generate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// T = 2ns
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// module instantiate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u_clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// stimulus
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;initial&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;$stop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// waveform
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;initial&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;$dumpfile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;wave.vcd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;$dumpvars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;整数分频&#34;&gt;整数分频
&lt;/h2&gt;&lt;p&gt;顾名思义，整数分频是指输入时钟的频率$f_\text{ref}$需要是输出时钟的频率$f_\text{out}$的&lt;strong&gt;整倍数&lt;/strong&gt;，即：
&lt;/p&gt;
$$
f_\text{ref} = N \times f_\text{out}, N\in \mathbb{N}_+
$$&lt;p&gt;
这一部分的电路实现在网上的各种博客中都有非常详细的讨论，此处只作简单说明。一般而言，我们会将其分为&lt;strong&gt;偶数分频&lt;/strong&gt;与&lt;strong&gt;奇数分频&lt;/strong&gt;两类进行考查：&lt;/p&gt;
&lt;h3 id=&#34;偶数分频&#34;&gt;偶数分频
&lt;/h3&gt;&lt;p&gt;对于偶数分频，假设分频数$N=2k$，则我们不难知道，如需保证分频时钟的占空比为&lt;strong&gt;50%&lt;/strong&gt;，则输出时钟的&lt;strong&gt;高电平脉宽&lt;/strong&gt;与&lt;strong&gt;低电平脉宽&lt;/strong&gt;均为$k$个输入时钟周期。因此，我们容易通过&lt;strong&gt;计数器&lt;/strong&gt;实现这一功能：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DIV_NUM&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// should be set to even
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PULSE_WIDTH_CYC&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DIV_NUM&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// cycle counter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DIV_NUM&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// output clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PULSE_WIDTH_CYC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，在偶数分频中，有一类非常特殊的情况，即$2^k$倍分频，对于这类分频器设计，一些博客给出的方案是这样的：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;采用触发器反向输出端连接到输入端的方式可实现二分频电路，随后将$k$个二分频电路的前级输出与后级时钟输入级联，即可构成$2^k$倍分频电路。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;对于这类方案，我们需要做一些额外的说明：这类利用触发器&lt;strong&gt;数据输出&lt;/strong&gt;与&lt;strong&gt;时钟输入&lt;/strong&gt;级联的方案一般只适用于&lt;strong&gt;全定制电路&lt;/strong&gt;设计，即设计人员从晶体管级开始对电路的各部分进行精细设计与布局，而不是依赖标准单元库或自动化后端工具。&lt;/p&gt;
&lt;p&gt;如果我们使用RTL代码对该模块进行描述的话，在进行后端综合时，这样$k$个触发器级联的结构其实额外引入了$k$个时钟域（每一级触发器的输入时钟频率都不相同），从而需要人为引入额外的时序约束确保电路的正确建模（甚至某些EDA本身就不支持这类数据输出与时钟输入相连的静态时序分析）。另外，这种描述在一些形式化验证工具中也可能直接导致验证失败。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;后续或许会写一篇博客讨论综合时各类时钟如何进行约束，这里先Mark一下~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以，在使用RTL代码设计$2^k$倍分频器时，我们仍然推荐使用前文的计数器实现，其实从面积占用的角度看，对于$2^k$倍分频，两者对应的电路面积均$\propto k$（假设电路面积主要由D触发器的个数决定），所以差异其实并不大。&lt;/p&gt;
&lt;h3 id=&#34;奇数分频&#34;&gt;奇数分频
&lt;/h3&gt;&lt;p&gt;对于奇数分频，假设分频数$N=2k+1$，此时如需保证分频时钟的占空比为&lt;strong&gt;50%&lt;/strong&gt;，则输出时钟的&lt;strong&gt;高电平脉宽&lt;/strong&gt;与&lt;strong&gt;低电平脉宽&lt;/strong&gt;均为$k+0.5$个输入时钟周期。这时我们会发现，前文基于计数器的实现方案失效了，因为计数器是输入时钟单边沿触发的，所以无法实现对半个时钟周期的计数。因此，我们需要进行分类讨论：&lt;/p&gt;
&lt;p&gt;第一，&lt;strong&gt;如果设计不严格要求输出时钟的占空比为50%&lt;/strong&gt;，那么前文基于计数器的实现方案仍然可以复用，我们取高电平脉宽&lt;strong&gt;或&lt;/strong&gt;低电平脉宽为$\lceil k+0.5\rceil$即可。&lt;/p&gt;
&lt;p&gt;第二，&lt;strong&gt;如果设计严格要求输出时钟的占空比为50%&lt;/strong&gt;，则需要考虑如何处理对半个输入时钟周期的计数，此处，我们首先给出如下结论：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;对于输入时钟的$2k+1$倍分频，如果我们生成了高电平脉宽为$k$个输入时钟周期的时钟（记为$\text{CP}$），同时将$\text{CP}$移相&lt;strong&gt;半个输入时钟周期&lt;/strong&gt;的时钟记为$\text{CN}$，则占空比严格为50%的$2k+1$倍分频时钟$\text{CLK}$为$\text{CP}$与$\text{CN}$进行&lt;strong&gt;或运算&lt;/strong&gt;的结果。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-004/odd_div.png&#34;
	width=&#34;680&#34;
	height=&#34;120&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-004/odd_div_hu_ae26527ce71d4cb3.png 480w, https://posvirus.github.io/p/dic-004/odd_div_hu_b2ec1c2435d306c4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;占空比为50%的奇数分频&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;566&#34;
		data-flex-basis=&#34;1360px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;我们可以结合上图理解这一结论，当$\text{CP}$与$\text{CN}$进行&lt;strong&gt;或运算&lt;/strong&gt;时，两者的高电平区间正好相差半个输入时钟周期，则运算结果的高电平脉宽即为$k+0.5$个输入时钟周期（对称地，我们也可以生成低电平脉宽为$k$个输入时钟周期的时钟，将其移相半个输入时钟周期后进行&lt;strong&gt;与运算&lt;/strong&gt;）。&lt;/p&gt;
&lt;p&gt;于是，问题便化归为：如何将时钟$\text{CP}$移相半个输入时钟周期？我们同样可以从&lt;strong&gt;全定制电路实现&lt;/strong&gt;与&lt;strong&gt;RTL代码描述&lt;/strong&gt;两个角度对其进行说明：&lt;/p&gt;
&lt;p&gt;对于全定制电路，我们仅需将$\text{CP}$连接至一个&lt;strong&gt;负边沿触发的触发器&lt;/strong&gt;的&lt;strong&gt;数据输入&lt;/strong&gt;，并使用原输入时钟采样即可，可用RTL代码描述如下（注意！这里仅仅是以RTL代码作为电路描述方式，实际实现时不可使用RTL描述，因为很多综合工具并不支持&lt;strong&gt;单个电路中同时存在正/负边沿触发&lt;/strong&gt;）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;assign&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于RTL描述，我们则可以同时例化两个前文基于计数器的分频器，一个使用&lt;strong&gt;负边沿触发&lt;/strong&gt;，一个使用&lt;strong&gt;正边沿触发&lt;/strong&gt;，最后两个分频器输出时钟的相位差即为半个输入时钟周期，基于前文&lt;code&gt;clk_divider&lt;/code&gt;模块的RTL实现示例如下（由于该模块在进行奇数分频时，输出的是低电平脉宽为$k$个输入时钟周期的时钟，因此我们最后需要进行&lt;strong&gt;与运算&lt;/strong&gt;）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DIV_NUM&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d5&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u_clk_divider_p&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cp&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DIV_NUM&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d5&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CNT_WIDTH&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u_clk_divider_n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;assign&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;有理数分频&#34;&gt;有理数分频
&lt;/h2&gt;&lt;h3 id=&#34;有理数分频的通用方法&#34;&gt;有理数分频的通用方法
&lt;/h3&gt;&lt;p&gt;除整数分频外，还有一类情况是&lt;strong&gt;有理数分频&lt;/strong&gt;，它通常需要输出时钟的频率$f_\text{out}$与输入时钟的频率$f_\text{ref}$满足：
&lt;/p&gt;
$$
f_\text{ref} = \frac{p}{q}\times f_\text{out},~p,q\in \mathbb{N}_+,~p&gt;q
$$&lt;blockquote&gt;
&lt;p&gt;上式中的$p&amp;gt;q$是为了保证$f_\text{ref}&amp;gt;f_\text{out}$，亦即保证我们在进行的是一个 &lt;strong&gt;“分频”&lt;/strong&gt; 的行为而非 &lt;strong&gt;“倍频”&lt;/strong&gt; 的行为。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;但这类需求在DIC中通常是无法实现的，观察输入/输出时钟的频率，对输入时钟的$p/q$倍分频实际上需要对输入时钟进行$q$倍频后，再进行$p$分频，而对于倍频，通常只能使用&lt;strong&gt;PLL&lt;/strong&gt;等模拟方案实现。&lt;/p&gt;
&lt;p&gt;因此，这里我们其实只能实现一个近似的有理数分频方案，我们对上式进行变化，记输入时钟与输出时钟的周期分别为$T_\text{ref}$与$T_\text{out}$，则：
&lt;/p&gt;
$$
\frac{1}{T_\text{ref}}=\frac{p}{q}\times\frac{1}{T_\text{out}}~\Rightarrow~q\times T_\text{out}=p\times T_\text{ref}
$$&lt;p&gt;
上式说明，对输入时钟的$p/q$倍分频其实需要保证&lt;strong&gt;在$p$个输入时钟周期内，输出时钟需要经过$q$个输入时钟周期&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;在有理数分频的近似实现中，我们仅需保证&lt;strong&gt;在$p$个输入时钟周期内，输出时钟经过$q$个输入时钟周期&lt;/strong&gt;这一条件即可，而无需考虑输入时钟的$q$个时钟周期是否均匀，占空比是否严格为50%。换言之，我们仅需在$p$个输入时钟周期内让输出时钟翻转$2q$次即可。&lt;/p&gt;
&lt;p&gt;但是，为了近似实现有理数分频的效果，我们仍然希望输出时钟的$2q$次翻转尽量均匀。在实际设计中，这通常是通过&lt;strong&gt;整数分频叠加&lt;/strong&gt;的方式实现的，具体而言，如果我们能找到一个整数$k$，使得&lt;strong&gt;在$p$个输入时钟周期内，我们可以恰好实现对输入时钟的$q-m$次$k$分频和$m$次$k+1$分频&lt;/strong&gt;，这样便可以从最大程度上保持输出时钟的均匀性&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;，从数学上描述，我们需要：
&lt;/p&gt;
$$
(q-m)\times k+m\times (k+1) = p,~m,k\in\mathbb{N}_+
$$&lt;p&gt;
以下，我们将通过求解得到$(m,k)$，首先，整理上式得到：
&lt;/p&gt;
$$
q\times k + m=p
$$&lt;p&gt;
两边同除$q$得到：
&lt;/p&gt;
$$
k=\frac{p}{q}-\frac{m}{q}
$$&lt;p&gt;
注意到$m&amp;lt;q$，因此$m/q &amp;lt;1$，所以我们可以直接取：
&lt;/p&gt;
$$
k=\left\lfloor\frac{p}{q}\right\rfloor
$$&lt;p&gt;
进而：
&lt;/p&gt;
$$
m=p-q\times k =p-q\times\left\lfloor\frac{p}{q}\right\rfloor=p~(\text{mod}~ q)
$$&lt;p&gt;
综上，求解得到的$(m,k)$为：
&lt;/p&gt;
$$
(m,k) = \left(p~(\text{mod}~ q),~\left\lfloor\frac{p}{q}\right\rfloor\right)
$$&lt;blockquote&gt;
&lt;p&gt;请注意，在上述分析中，我们并没有规定$p$与$q$需要互质，换言之，对于一个确定的有理数分频设计，$k$是确定的，但是$m$是与$(p,~q)$相关的，我们可以对$(p,~q)$进行等比例缩放以对$m$进行缩放。比如，我们要实现&lt;strong&gt;5.4倍&lt;/strong&gt;分频，则易得$k=5$，而对于$m$，我们既可以取$(p,~q)$为$(54,~10)$，此时$m=4$，即需要在&lt;strong&gt;54个输入时钟周期&lt;/strong&gt;内，实现对输入时钟的&lt;strong&gt;6次5分频&lt;/strong&gt;和&lt;strong&gt;4次6分频&lt;/strong&gt;；也可以取$(p,~q)$为$(27,~5)$，此时$m=2$，即需要在&lt;strong&gt;27个输入时钟周期&lt;/strong&gt;内，实现对输入时钟的&lt;strong&gt;3次5分频&lt;/strong&gt;和&lt;strong&gt;2次6分频&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;$(p,~q)$的选取通常没有固定的规则，但我们至少需要保证$(p,~q)$适当大，这样可以在更大的时间尺度上实现对$k$分频与$k+1$分频的均匀分配，进而降低输出时钟的偏斜。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;至此，我们已经确定了$(m,k)$的取值，之后仅需在$p$个输入时钟周期内，实现对输入时钟的$q-m$次$k$分频和$m$次$k+1$分频即可。但是这里还有一个问题，我们应该如何确定$q-m$次$k$分频和$m$次$k+1$分频的先后顺序呢？&lt;/p&gt;
&lt;p&gt;对于这个问题，决策的根本依据肯定是希望&lt;strong&gt;通过对这$q$次分频进行合理排序，使得输出时钟的$2q$次翻转尽量均匀&lt;/strong&gt;，关键是如何量化输出时钟翻转的 &lt;strong&gt;“均匀性”&lt;/strong&gt; ，这里我们通常通过最小化&lt;strong&gt;若干次分频后，理想输出时钟周期数（以输入时钟周期为单位）与实际输出时钟周期数（以输入时钟周期为单位）的差值&lt;/strong&gt;进行决策，这可以通过如下数学建模描述：&lt;/p&gt;
&lt;p&gt;对于输入时钟的一次$k$分频而言，分频后的时钟周期长度为$k$个输入时钟周期，其与理想的$p/q$分频的时钟周期长度差值为$t=p/q-k$个输入时钟周期；对于输入时钟的一次$k+1$分频而言，分频后的时钟周期长度为$k$个输入时钟周期，其与理想的$p/q$分频的时钟周期长度差值为$t-1$个输入时钟周期&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;进而，我们得到了一个包含$q-m$个$t$与$m$个$t-1$的无序序列，且满足：
&lt;/p&gt;
$$
(q-m)\times t+m\times(t-1)=0
$$&lt;p&gt;我们的目标即是找到将该无序序列排序为一个有序数组 $\{a_n\}$ 的方案，使得数组 $\{S_n\}$ ：
&lt;/p&gt;
$$
S_n=\sum\limits_{i=1}^na_i,~1\leqslant i\leqslant q
$$&lt;p&gt;
满足在所有排序方案中，$\max\limits_{1\leqslant n\leqslant q}{|S_n|}$ 取最小值。&lt;/p&gt;
&lt;p&gt;以下，我们来解决上述问题：&lt;/p&gt;
&lt;p&gt;首先消去变量$t$，已知：
&lt;/p&gt;
$$
t=\frac{p}{q}-k=\frac{p-k\times q}{q}=\frac{m}{q}~\Rightarrow~t-1=\frac{m-q}{q}
$$&lt;p&gt;
因此，我们若记有序数组$\{a_n\}$的前$n$项中$t$的个数为$x_n$，则：
&lt;/p&gt;
$$
S_n=\sum\limits_{i=1}^na_i=x_n\times t+(n-x_n)\times(t-1)=n\times(t-1)+x_n
$$&lt;p&gt;
进而：
&lt;/p&gt;
$$
\left|S_n\right|=\left|x_n-\frac{n\times(q-m)}{q}\right|
$$&lt;p&gt;
直观看来，我们只需要保证$x_n$尽可能接近$n\times (q-m)/q$即可。以下，我们给出一种方案，并证明该方案的最优性，该方案可使用伪代码描述如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;temporary&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;variable&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;endif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;endfor&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;比如，对于前文的$(p,~q)=(54,~10)$的情况，需要对输入时钟进行&lt;strong&gt;6次5分频&lt;/strong&gt;和&lt;strong&gt;4次6分频&lt;/strong&gt;，这可通过如下过程确定分频顺序：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$x=0$，$(q-m)/q=0.6$，则$[ 1\times 0.6]=1&amp;gt;x$&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=1$。&lt;/li&gt;
&lt;li&gt;$[2\times0.6]=1=x$，插入&lt;strong&gt;6分频&lt;/strong&gt;，$x$保持不变。&lt;/li&gt;
&lt;li&gt;$[3\times 0.6]=2&amp;gt;x$，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=2$。&lt;/li&gt;
&lt;li&gt;$[4\times0.6]=2=x$，插入&lt;strong&gt;6分频&lt;/strong&gt;，$x$保持不变。&lt;/li&gt;
&lt;li&gt;$[5\times0.6]=3&amp;gt;x$，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=3$。&lt;/li&gt;
&lt;li&gt;$[6\times0.6]=4&amp;gt;x$，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=4$。&lt;/li&gt;
&lt;li&gt;$[7\times0.6]=4=x$，插入&lt;strong&gt;6分频&lt;/strong&gt;，$x$保持不变。&lt;/li&gt;
&lt;li&gt;$[8\times0.6]=5&amp;gt;x$，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=5$。&lt;/li&gt;
&lt;li&gt;$[9\times0.6]=5=x$，插入&lt;strong&gt;6分频&lt;/strong&gt;，$x$保持不变。&lt;/li&gt;
&lt;li&gt;$[10\times0.6]=6&amp;gt;x$，插入&lt;strong&gt;5分频&lt;/strong&gt;，同时令$x=6$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;综上，插入的顺序即为：$5,~6,~5,~6,~5,~5,~6,~5,~6,~5$。&lt;/p&gt;
&lt;p&gt;分析该方案，其实我们不难发现，这里的$x$其实就代表着有序数组前$n$项中$t$的个数，亦即：
&lt;/p&gt;
$$
x_n=\left[\frac{n\times (q-m)}{q}\right]
$$&lt;p&gt;
这是因为在该方案的操作过程中，如果对于某个$n$，满足：
&lt;/p&gt;
$$
\left[\frac{n\times (q-m)}{q}\right]\leqslant x,~\left[\frac{(n+1)\times (q-m)}{q}\right]&gt; x
$$&lt;p&gt;
则由于：
&lt;/p&gt;
$$
\left|\frac{(n+1)\times (q-m)}{q}-\frac{n\times (q-m)}{q}\right|=\frac{q-m}{q}&lt;1
$$&lt;p&gt;
因此根据$n\times(q-m)/q$, $x$, $(n+1)\times(q-m)/q$在数轴上的分布，一定有：
&lt;/p&gt;
$$
\left[\frac{(n+1)\times (q-m)}{q}\right]= x+1
$$&lt;p&gt;
换言之，$x$每次改变，一定只会&lt;strong&gt;递增1&lt;/strong&gt;，而每次$x$改变时又对应着在有序数组中插入$t$的操作，递归地，可验证上述结论的正确性。&lt;/p&gt;
&lt;p&gt;最后，我们来证明该方案的最优性：&lt;/p&gt;
&lt;p&gt;我们构造新数列$\{f_n\}$，用于描述$n\times(q-m)/q$的小数部分，即：
&lt;/p&gt;
$$
f_n=\left\{\frac{n\times(q-m)}{q}\right\},~1\leqslant n\leqslant q
$$&lt;p&gt;
于是对于该方案，由于$x_n$是对$n\times(q-m)/q$的四舍五入取整，因此不难得到：
&lt;/p&gt;
$$
\left|S_n\right|=\left|x_n-\frac{n\times(q-m)}{q}\right|=\min\{f_n,~1-f_n\}
$$&lt;p&gt;
进而：
&lt;/p&gt;
$$
\max\limits_{1\leqslant n\leqslant q}\{|S_n|\}=\max\limits_{1\leqslant n\leqslant q}\{\min\{f_n,~1-f_n\}\}=K
$$&lt;p&gt;
注意$K$是一个仅与$(p,~q)$有关的值，它与我们选择的排序方案无关。以下我们将证明，对于任意的排序方案，$\max\limits_{1\leqslant n\leqslant q}{|S_n|}$一定不小于$K$：假设一种排序方案，前$n$项中$t$的个数为$x_n$，则注意到$x_n$是整数，易得：
&lt;/p&gt;
$$
\left|S_n\right|=\left|x_n-\frac{n\times(q-m)}{q}\right|\geqslant\min\{f_n,~1-f_n\}
$$&lt;p&gt;
进而：
&lt;/p&gt;
$$
\max\limits_{1\leqslant n\leqslant q}\{|S_n|\}\geqslant\max\limits_{1\leqslant n\leqslant q}\{\min\{f_n,~1-f_n\}\}=K
$$&lt;p&gt;
综上，我们即证明了前文提及排序方案的最优性。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意前文的所有分析，是在确定对于给定的有理数分频，我们应当如何选择若干次整数分频进行近似，以及这若干次整数分频应当如何排序以保证输出时钟的翻转尽量均匀。&lt;strong&gt;这些过程都是在进行分频器的硬件实现前就确定的，并不需要通过RTL代码描述。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在确定$q$次分频的排序方案后，我们便可进行分频器的RTL设计，我们不妨再以&lt;strong&gt;5.4倍分频&lt;/strong&gt;为例，给出如下示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk_divider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_Q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0101001010&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ALC_CNT_WIDTH&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;localparam&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CYC_CNT_WIDTH&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// allocation counter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CYC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_Q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;({(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_Q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;({(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// cycle counter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CYC_CNT_WIDTH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// output clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_ORDER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alc_cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyc_cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FRAC_K&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;clk_out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;当然，需要指出的是，$k$与$k+1$中必有一者是奇数，因此在处理有理数分频时，我们同时也需要处理奇数分频。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;半整数分频&#34;&gt;半整数分频
&lt;/h3&gt;&lt;p&gt;最后，我们讨论一种特殊的有理数分频，即对输入时钟进行 &lt;strong&gt;$n+0.5$倍分频&lt;/strong&gt; （简称半整数分频），此时我们知道，输出时钟的周期$T_\text{out}$与输入时钟的周期$T_\text{ref}$需满足：
&lt;/p&gt;
$$
T_\text{out}=\left(n+0.5\right)\times T_\text{ref}
$$&lt;p&gt;
但这里我们不难发现，对于半个输入时钟周期的延时，我们是有可能利用&lt;strong&gt;输入时钟的双边沿触发&lt;/strong&gt;精确实现的，故可以对其进一步优化：&lt;/p&gt;
&lt;p&gt;以下，我们不妨先按照通用方法实现，则：
&lt;/p&gt;
$$
\frac{p}{q}=\frac{1}{2}+n=\frac{2n+1}{2}
$$&lt;p&gt;
因此，我们可取$(p,~q)=(2n+1,~2)$，则$(m,~k)=(1,~n)$，这说明我们可以在$2n+1$个输入时钟周期内，通过对输入时钟的一次$n$分频与一次$n+1$分频近似$n+0.5$分频的效果。&lt;/p&gt;
&lt;p&gt;以下，我们进行如下操作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;以&lt;strong&gt;输入时钟上升沿&lt;/strong&gt;触发，顺次进行$k+1$分频与$k$分频，各分频时钟的高电平脉宽均为$\left\lfloor k/2\right\rfloor$个输入时钟周期，得到输出时钟$\text{CP}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;以&lt;strong&gt;输入时钟上升沿&lt;/strong&gt;触发，顺次进行$k$分频与$k+1$分频，并将其&lt;strong&gt;移相半个时钟周期&lt;/strong&gt;，各分频时钟的高电平脉宽均为$\left\lfloor k/2\right\rfloor$个输入时钟周期，得到输出时钟$\text{CN}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;取$\text{CLK}$为$\text{CP}$与$\text{CN}$进行&lt;strong&gt;或运算&lt;/strong&gt;的结果，则$\text{CLK}$的周期即为$k+0.5$个输入时钟周期。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;上述操作本质上是对$k+1$分频时钟与$k$分频时钟进行平均化操作，此处便不进行严格证明了，我们不妨以&lt;strong&gt;3.5倍分频&lt;/strong&gt;为例，展示其效果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://posvirus.github.io/p/dic-004/half_div.png&#34;
	width=&#34;1040&#34;
	height=&#34;120&#34;
	srcset=&#34;https://posvirus.github.io/p/dic-004/half_div_hu_9ff0e4356a9350ed.png 480w, https://posvirus.github.io/p/dic-004/half_div_hu_a665734d5027a1d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;精确周期的半整数分频&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;866&#34;
		data-flex-basis=&#34;2080px&#34;
	
&gt;&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;这种方法通常被称为&lt;strong&gt;双模前置小数分频法&lt;/strong&gt;。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;这里取$t-1&amp;lt;0$，代表分频后的时钟周期长度大于理想分频后的时钟周期长度。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;这里的$[x]$代表对$x$进行&lt;strong&gt;四舍五入取整&lt;/strong&gt;。&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>序列检测</title>
        <link>https://posvirus.github.io/p/dic-003/</link>
        <pubDate>Thu, 06 Nov 2025 12:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-003/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-003/cicc.png" alt="Featured image of post 序列检测" /&gt;&lt;p&gt;本文主要讨论DIC中的 &lt;strong&gt;序列检测器（Sequence Detector）&lt;/strong&gt; 电路设计，这是一种非常经典的功能性电路，它通常用于检测二进制序列输入中的某个特定模式的子序列，其模块端口声明通常如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;seq_detector&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// system clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// reset
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// serial data input
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// detected signal
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;cm&#34;&gt;/* internal logic */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;序列检测问题的分类&#34;&gt;序列检测问题的分类
&lt;/h2&gt;&lt;p&gt;目前网上的博客已对序列检测问题进行了非常详细的分类&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;，具体而言，我们可以从检测问题本身与电路设计两个方面对其进行分类：&lt;/p&gt;
&lt;p&gt;从序列检测问题本身，其可分为&lt;strong&gt;重复检测&lt;/strong&gt;与&lt;strong&gt;非重复检测&lt;/strong&gt;两类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;重复检测指在输入数据流中，若已匹配序列的&lt;strong&gt;尾部与后续输入构成新的有效序列&lt;/strong&gt;（即存在重叠部分），则允许&lt;strong&gt;连续多次触发匹配信号&lt;/strong&gt;。检测器在完成一次匹配后，&lt;strong&gt;不强制回到初始状态&lt;/strong&gt;。常用于需要捕获所有可能实例的场景（如通信协议中的帧头检测）。&lt;/li&gt;
&lt;li&gt;非重复检测指一旦匹配到完整的目标序列，检测器&lt;strong&gt;立即复位到初始状态&lt;/strong&gt;，忽略该序列尾部可能参与构成的新的有效序列。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;重复匹配与非重复匹配的本质区别在于在&lt;strong&gt;完成匹配后&lt;/strong&gt;的状态跳转。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从电路设计角度，其可分为&lt;strong&gt;状态机型&lt;/strong&gt;与&lt;strong&gt;移位寄存器型&lt;/strong&gt;两类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;状态机型电路即是对序列检测问题进行行为级建模，在各二进制比特输入之后判断是否匹配，若匹配则进入下一状态，不匹配则根据&lt;strong&gt;输入数据&lt;/strong&gt;与&lt;strong&gt;序列检测的类型&lt;/strong&gt;具体判断进入的下一状态。&lt;/li&gt;
&lt;li&gt;移位寄存器型电路的思路则相对简单，其基本原理是目标序列与缓存数据的对比：我们可以使用一个与目标序列等位宽的移位寄存器缓存输入的序列，当该缓存序列与目标序列一致时，则代表匹配成功。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这两类电路的RTL描述都较为简单，此处不作赘述。&lt;/p&gt;
&lt;h2 id=&#34;序列检测器的电路设计&#34;&gt;序列检测器的电路设计
&lt;/h2&gt;&lt;p&gt;本节简要讨论&lt;strong&gt;状态机型&lt;/strong&gt;与&lt;strong&gt;移位寄存器型&lt;/strong&gt;两类序列检测器的门级电路实现。因为在某些面试中，除了手撕代码外，可能还涉及对电路原理图的绘制。&lt;/p&gt;
&lt;p&gt;对于状态机型序列检测器，该电路是非常典型的&lt;strong&gt;Mealy型状态机&lt;/strong&gt;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;，对于位宽为$N$的序列，可以建模一个状态位宽为$M=\lceil\log_2(N)\rceil$的状态机实现序列检测，之后便化归为最基本的基于状态转换图推导状态转换方程的问题：
&lt;/p&gt;
$$
(Q_{n+1}^1,~Q_{n+1}^2, ~\cdots,~Q_{n+1}^M) = \vec{f}(Q_{n}^1,~Q_{n}^2, ~\cdots,~Q_{n}^M,~\text{Input})
$$&lt;p&gt;
得到状态转换方程后，我们可以绘制对应的状态机电路，而对序列匹配输出&lt;code&gt;match&lt;/code&gt;，只需要再加一级比较当前状态与序列匹配状态是否相等的组合逻辑即可。&lt;/p&gt;
&lt;p&gt;对于移位寄存器型序列检测器，对于位宽为$N$的序列，我们只需要将$N$个D触发器级联构成移位寄存器，并将其各位的输出引出实现与目标序列的比较即可。&lt;/p&gt;
&lt;h2 id=&#34;序列检测器的参数化设计&#34;&gt;序列检测器的参数化设计
&lt;/h2&gt;&lt;p&gt;在讨论完序列检测器的分类与电路实现后，我们需要考查&lt;strong&gt;状态机型&lt;/strong&gt;与&lt;strong&gt;移位寄存器型&lt;/strong&gt;两类序列检测器对&lt;strong&gt;重复检测&lt;/strong&gt;与&lt;strong&gt;非重复检测&lt;/strong&gt;两类序列检测问题的适配性。在一些博客中&lt;sup id=&#34;fnref1:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;，会给出“状态机型序列检测器可以同时处理重复检测与非重复检测两类序列检测问题，但移位寄存器型序列检测器只能处理重复检测序列检测问题”的结论，这一结论实际上是&lt;strong&gt;错误的&lt;/strong&gt;，本节将进行简要讨论。&lt;/p&gt;
&lt;p&gt;首先，状态机型序列检测器可以同时处理重复检测与非重复检测两类序列检测问题，这一结论是正确的，因为状态转换逻辑可以根据问题类型灵活变化。&lt;/p&gt;
&lt;p&gt;但是，对于移位寄存器型序列检测器，其不仅可以处理序列的重复检测问题（这是显然的），也可以处理序列的非重复检测问题。对于非重复检测，我们需要意识到移位寄存器中存储的序列本身就是电路的 &lt;strong&gt;“状态”&lt;/strong&gt; ，因此，我们只需将序列匹配输出信号&lt;code&gt;match&lt;/code&gt;反馈至移位寄存器，使移位寄存器在序列匹配时&lt;strong&gt;复位&lt;/strong&gt;即可。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;移位寄存器的复位：&lt;strong&gt;我们需要思考一个问题，移位寄存器的&lt;/strong&gt;复位&lt;/strong&gt;具体指什么？我们可以将清零与复位完全等价吗？答案是否定的，假设我们需要检测的序列是&lt;code&gt;4&#39;b0011&lt;/code&gt;，高位先输入，而我们将移位寄存器清零后，移位寄存器的最低位便是&lt;code&gt;1&#39;b0&lt;/code&gt;，此时我们如果输入&lt;code&gt;3&#39;b011&lt;/code&gt;，最低位的复位值移位至最高位，移位寄存器的值变为&lt;code&gt;4&#39;b0011&lt;/code&gt;，移位寄存器也会错误地将该序列视为匹配序列。&lt;/p&gt;
&lt;p&gt;所以，为避免这一点，移位寄存器的复位值需要依据匹配的序列进行指定。具体而言，我们必须保证&lt;strong&gt;移位寄存器各位的复位值与目标序列最高位相反（默认高位先输入）&lt;/strong&gt;，这样可以保证在&lt;strong&gt;移位寄存器复位&lt;/strong&gt;到&lt;strong&gt;移位寄存器复位值完全被输入序列覆盖&lt;/strong&gt;这一段时间内，不会发生错误的序列匹配。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以，基于上述说明，并不存在“状态机型序列检测器比移位寄存器型序列检测器更灵活”的说法，相反，移位寄存器简洁的结构与原理，使其可以实现序列匹配电路的参数化设计，而这是状态机型电路难以实现的：&lt;/p&gt;
&lt;p&gt;对于&lt;strong&gt;非重复检测&lt;/strong&gt;，对应的序列检测电路可实现如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;seq_detector&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;8&amp;#39;h5A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;8&lt;/span&gt;              
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// system clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// reset
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// serial data input
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// detected signal
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// shift register
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]}};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// diff MSB
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]}};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// diff MSB
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// bit shift
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// compare output
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于&lt;strong&gt;重复检测&lt;/strong&gt;，我们只需消除序列匹配输出信号的反馈路径即可，对应的序列检测电路可实现如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;seq_detector&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;8&amp;#39;h5A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;parameter&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;8&lt;/span&gt;              
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// system clock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// reset
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;input&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// serial data input
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// detected signal
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// shift register
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]}};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// diff MSB
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// bit shift
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// compare output
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;negedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shift_reg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;同时我们提供一个简单的Testbench，其检测序列模式为&lt;code&gt;4&#39;b1001&lt;/code&gt;，对应输入序列为&lt;code&gt;13&#39;b1001001001001&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// clock generate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;always&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// module instantiate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;wire&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;seq_detector&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;#(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1001&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SEQ_LEN&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u_seq_detector&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// stimulus
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;serial_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;initial&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;serial_in&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1001001001001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;rst_n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mb&#34;&gt;&amp;#39;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;serial_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;integer&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;data_in&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;serial_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;@(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;posedge&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;$stop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// waveform
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;initial&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;begin&lt;/span&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;$dumpfile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;wave.vcd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;$dumpvars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endmodule&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;另外，在电路面积上，假设需检测的序列位宽为$N$，则状态机型电路的面积$\propto \log N$（假设电路面积主要由D触发器的个数决定），而移位寄存器型电路的面积$\propto N$。同时，移位寄存器型电路具有相对短的关键路径，因此可以达到相当高的工作频率。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/Loudrs/article/details/130292586&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;序列检测器（两种设计方法和四种检测模式|verilog代码|Testbench|仿真结果）&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref1:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;输出信号不仅取决于当前状态，还取决于输入信号的值。对应地，Moore型状态机的输出信号只取决于当前状态。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>task与function的区别</title>
        <link>https://posvirus.github.io/p/dic-002/</link>
        <pubDate>Thu, 06 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-002/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-002/cicc.png" alt="Featured image of post task与function的区别" /&gt;&lt;h2 id=&#34;task与function的区别&#34;&gt;&lt;code&gt;task&lt;/code&gt;与&lt;code&gt;function&lt;/code&gt;的区别
&lt;/h2&gt;&lt;p&gt;任务（&lt;code&gt;task&lt;/code&gt;）与函数（&lt;code&gt;function&lt;/code&gt;）两类语句在标准中的 &lt;strong&gt;第10章（Tasks and functions）&lt;/strong&gt; 做了详细讨论，以下我们以原文为基础进行讨论说明：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[10.1] The following rules distinguish tasks from functions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A function shall execute in one simulation time unit; a task can contain time-controlling statements.&lt;/li&gt;
&lt;li&gt;A function cannot enable a task; a task can enable other tasks and functions.&lt;/li&gt;
&lt;li&gt;A function shall have at least one input type argument and shall not have an output or inout type argument; a task can have zero or more arguments of any type.&lt;/li&gt;
&lt;li&gt;A function shall return a single value; a task shall not return a value.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;上文主要给出了&lt;code&gt;task&lt;/code&gt;与&lt;code&gt;function&lt;/code&gt;的四点不同：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先，函数必须在一个仿真时间单位内执行完毕；而任务可以包含控制仿真时间的语句。这句话的意思是&lt;strong&gt;函数不能消耗仿真时间&lt;/strong&gt;。换言之，函数的执行被认为是&lt;strong&gt;瞬时完成的&lt;/strong&gt;，在调用它的那个仿真时间点上立即返回结果。因此，函数内部&lt;strong&gt;不允许出现任何会延迟仿真时间的语句&lt;/strong&gt;。而&lt;strong&gt;任务可以包含任何时序控制语句&lt;/strong&gt;，因此它可以跨越多个仿真时间单位执行&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/li&gt;
&lt;li&gt;函数不能 &lt;strong&gt;使能（enable）&lt;strong&gt;任务，而任务可以使能其它任务与函数。注意，这里的&lt;/strong&gt;使能&lt;/strong&gt;可以理解为&lt;strong&gt;调用并执行&lt;/strong&gt;，即某个任务可以在其内部调用其它函数或任务，并使其在仿真运行时被触发执行。至于为什么规定函数不能使能任务，我们可以结合第一条差异理解，因为函数是&lt;strong&gt;瞬时执行完成的&lt;/strong&gt;，如果在其中引入可跨越多个仿真时间单位执行的任务，则会导致未定义的行为。&lt;/li&gt;
&lt;li&gt;函数至少需要有一个&lt;code&gt;input&lt;/code&gt;类型的参数，且不能有&lt;code&gt;output&lt;/code&gt;或&lt;code&gt;inout&lt;/code&gt;类型的参数。而任务可以有任意个任意类型的参数。&lt;/li&gt;
&lt;li&gt;函数需要一个返回值，而任务不应存在返回值。&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;[10.1] The purpose of a function is to respond to an input value by returning a single value. A task can support multiple goals and can calculate multiple result values. However, only the output or inout type arguments pass result values back from the invocation of a task. A function is used as an operand in an expression; the value of that operand is the value returned by the function.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;上文归纳了&lt;code&gt;task&lt;/code&gt;与&lt;code&gt;function&lt;/code&gt;语句的目的，总体而言，函数主要是为了就某一输入值返回单一的输出值，其通常作为表达式内的操作数。而任务则可以支持更灵活的功能，输出更多的返回值，任务的返回值通常通过&lt;code&gt;output&lt;/code&gt;与&lt;code&gt;inout&lt;/code&gt;类型的参数进行传递。&lt;/p&gt;
&lt;h2 id=&#34;有关task与function的其它注意点&#34;&gt;有关&lt;code&gt;task&lt;/code&gt;与&lt;code&gt;function&lt;/code&gt;的其它注意点
&lt;/h2&gt;&lt;p&gt;本节主要结合标准说明有关&lt;code&gt;task&lt;/code&gt;与&lt;code&gt;function&lt;/code&gt;的一些其他知识点：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[10.2.1] Tasks without the optional keyword automatic are static tasks, with all declared items being statically allocated. These items shall be shared across all uses of the task executing concurrently. Task with the optional keyword automatic are automatic tasks. All items declared inside automatic tasks are allocated dynamically for each invocation. Automatic task items cannot be accessed by hierarchical references. Automatic tasks can be invoked through use of their hierarchical name.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;[10.4.1] The keyword automatic declares an automatic function that is reentrant, with all the function declarations allocated dynamically for each concurrent function call. Automatic function items cannot be accessed by hierarchical references. Automatic functions can be invoked through the use of their hierarchical name&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第一是函数与任务的调用，在该方面标准对函数与任务的规定是类似的，因此我们仅以任务为例进行说明：&lt;/p&gt;
&lt;p&gt;标准规定，如果定义的任务没有被&lt;code&gt;automatic&lt;/code&gt;关键字修饰，则该任务为 &lt;strong&gt;静态任务（static task）&lt;/strong&gt; ，这类任务内部的所有变量都是静态分配的，这意味着这些变量在仿真开始时就被分配好内存，并且&lt;strong&gt;在整个仿真过程中只有一份副本&lt;/strong&gt;。此时，如果果多个块内同时调用同一个静态 task（例如在两个并行的 &lt;code&gt;initial&lt;/code&gt; 块中），那么它们&lt;strong&gt;共享同一组内部变量&lt;/strong&gt;。这可能会导致&lt;strong&gt;数据竞争&lt;/strong&gt;：当一个调用修改了变量，另一个调用会看到这个修改，可能引发 &lt;strong&gt;不可预测的行为（UB）&lt;/strong&gt; 。&lt;/p&gt;
&lt;p&gt;因此，标准引入了&lt;code&gt;automatic&lt;/code&gt;关键字，如果我们使用该关键字修饰一个任务：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;task&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;automatic&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;my_auto_task&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;cm&#34;&gt;/* do something */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;endtask&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该任务会被声明为&lt;strong&gt;自动任务（automatic task）&lt;/strong&gt; ，此时，对该任务的每次调用，都会动态分配一份新的内存空间，因此，&lt;strong&gt;多个并发调用之间互不干扰&lt;/strong&gt;，各自拥有独立的变量副本，避免了数据竞争。&lt;/p&gt;
&lt;p&gt;但是，对于&lt;strong&gt;自动任务&lt;/strong&gt;而言：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;你不能通过&lt;code&gt;top.inst.my_auto_task.var&lt;/code&gt;之类的层次化引用语句访问任务内部的变量，因为自动任务的变量是动态分配的，可能同时存在多个实例，仿真器无法确定你要访问哪一个副本。&lt;/li&gt;
&lt;li&gt;你可以通过&lt;code&gt;top.inst.my_auto_task(...)&lt;/code&gt;指令的层次化调用语句来调用任务本身，只是不能读写它的内部变量。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第二，函数与任务都是&lt;strong&gt;可综合的&lt;/strong&gt;，但需要指出，函数和任务综合出的电路都是组合逻辑，换言之，如果需要对函数与任务进行综合，你不应在其中引入任何时序控制语句。&lt;/p&gt;
&lt;p&gt;注意，有关函数与任务是否可综合，其实在标准中并没有进行说明。这是因为 &lt;strong&gt;可综合性（Synthesizability）&lt;/strong&gt; 是一个&lt;strong&gt;由综合工具厂商定义和实现的概念&lt;/strong&gt;，而不是语言标准本身强制规定的。一个 Verilog语句是否可综合，取决于综合工具能否将其转换为实际的硬件电路。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;对于第一条差异，多篇博客将其翻译为“函数只能与主模块共用同一个仿真时间单位，而任务可以定义自己的仿真时间单位”，这是不准确的。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>Verilog中的有符号数</title>
        <link>https://posvirus.github.io/p/dic-001/</link>
        <pubDate>Tue, 04 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://posvirus.github.io/p/dic-001/</guid>
        <description>&lt;img src="https://posvirus.github.io/p/dic-001/cicc.png" alt="Featured image of post Verilog中的有符号数" /&gt;&lt;h2 id=&#34;写在前面&#34;&gt;写在前面
&lt;/h2&gt;&lt;p&gt;这一系列博客主要用于记录我在 &lt;strong&gt;数字集成电路（Digital Integrated Circuit, DIC）&lt;/strong&gt; 中遇到或偶然想到的一些问题，以及日常在各个平台看到的面试八股，以期为明年的秋招做一些准备。集成电路的知识较为繁杂，想要构建清晰的分类体系会消耗太多不必要的精力，所以这里统一以&lt;code&gt;[DIC-XXX]&lt;/code&gt;为博客编号。&lt;/p&gt;
&lt;p style=&#39;text-align: right;&#39;&gt;Chen Wenyao&lt;/p&gt;
&lt;p style=&#39;text-align: right;&#39;&gt;updated at November 3rd, 2025&lt;/p&gt;
&lt;h2 id=&#34;verilog中的有符号数&#34;&gt;Verilog中的有符号数
&lt;/h2&gt;&lt;p&gt;前几天，我在编写一个ALU模块，它需要同时支持有符号数与无符号数大小比较的功能，但我对这部分内容的了解恰巧比较模糊，所以想借本篇博客系统地探讨一下Verilog语法中与有符号数有关的话题。&lt;/p&gt;
&lt;p&gt;在写这篇博客之前，我试图在网上搜索相关的内容，但只找到了两类结果，一类是AI生成的💩，另一类倒是给出了一些简单结论，但是这些结论基本是作者在诸如Vivado之类的EDA上用几个简单的测试归纳总结得到的，所以每个作者得到的结论不尽相同，弄得我有些莫名其妙，不知道该信谁。&lt;/p&gt;
&lt;p&gt;这里我想提一句，我觉得上文提到的使用仿真器测试归纳Verilog语法特性是一种典型的错误行为（可以称之为DIC中的&lt;strong&gt;Spice Monkey&lt;/strong&gt;），因为仿真器所反应的Verilog语法特性本身是遵循&lt;strong&gt;Verilog标准&lt;/strong&gt;的，而这种行为其实是试图通过仿真器中的简单测试去 &lt;strong&gt;“逆向”&lt;/strong&gt; Verilog标准中所描述的特性，这样最终得到的结论无论是在全面性还是准确性上肯定都存在一定欠缺。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;当然，这里可能有人会问，如果EDA本身对Verilog语法特性的支持与Verilog标准不一致怎么办呢，这就是EDA厂商需要考虑的事情了。作为IC设计人员，我觉得应该达成的一个共识是：&lt;strong&gt;我们应当面向标准设计，而不是面向EDA设计。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以，最好的方法是直接阅读Verilog标准，从标准中寻找答案。这里，我选择&lt;strong&gt;Verilog-2005标准（IEEE 1364-2005）&lt;/strong&gt;，它可以在&lt;a class=&#34;link&#34; href=&#34;https://ieeexplore.ieee.org/document/1620780&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;找到。&lt;/p&gt;
&lt;p&gt;由于我主要关注的是在算数逻辑表达式中有符号数与无符号数的特性，因此以下我将主要选取 &lt;strong&gt;标准第5章（Expressions）&lt;/strong&gt; 的相关内容，进行翻译以及归纳：&lt;/p&gt;
&lt;h3 id=&#34;表达式中的整型数&#34;&gt;表达式中的整型数
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;[5.1.3] A negative value for an integer with no base specifier shall be interpreted differently from an integer with a base specifier. An integer with no base specifier shall be interpreted as a signed value in twos-complement form. An integer with an unsigned base specifier shall be interpreted as an unsigned value.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;当整型数（&lt;code&gt;integer&lt;/code&gt;）出现在表达式中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果其没有&lt;strong&gt;基数标识符（base specifier, 如&lt;code&gt;&#39;d&lt;/code&gt;）&lt;/strong&gt;，则被视为&lt;strong&gt;有符号数&lt;/strong&gt;处理；&lt;/li&gt;
&lt;li&gt;如果其有基数标识符，但没有指定为有符号数（如&lt;code&gt;&#39;sd&lt;/code&gt;代表指定该数为有符号数），则被视为&lt;strong&gt;无符号数&lt;/strong&gt;处理；&lt;/li&gt;
&lt;li&gt;如果其有基数标识符，也被指定为有符号数，则被视为&lt;strong&gt;有符号数&lt;/strong&gt;处理。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;标准中给出了一些例子，用于辅助说明：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;integer&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IntA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;IntA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// The result is -4.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IntA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// The result is 1431655761.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IntA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sd&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// The result is -4.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IntA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sd&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// -4&amp;#39;sd12 is the negative of the 4-bit
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                     &lt;span class=&#34;c1&#34;&gt;// quantity 1100, which is -4. -(-4) = 4.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                     &lt;span class=&#34;c1&#34;&gt;// The result is 1.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;注意区分整型数与整型数变量，前者是一个常量，后者是使用&lt;code&gt;integer&lt;/code&gt;作为类型声明的变量，这一节说明的其实是表达式中的整型数（非变量）的符号处理规则，比如&lt;code&gt;-&#39;d 12&lt;/code&gt;为无符号数，&lt;code&gt;-&#39;sd 12&lt;/code&gt;为有符号数等。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;算数表达式中的变量&#34;&gt;算数表达式中的变量
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;[5.1.6] A value assigned to a reg variable or a net shall be treated as an unsigned value unless the reg variable or net has been explicitly declared to be signed. A value assigned to an integer, real or realtime variable shall be treated as signed. A value assigned to a time variable shall be treated as unsigned. Signed values, except for those assigned to real and realtime variables, shall use a twos-complement representation. Values assigned to real and realtime variables shall use a floating-point representation. Conversions between signed and unsigned values shall keep the same bit representation; only the interpretation changes.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里主要给出了算数表达式（进行算数运算的表达式）中一些变量类型（如&lt;code&gt;wire&lt;/code&gt;, &lt;code&gt;reg&lt;/code&gt;等）的默认符号类型，其可以归纳为下表：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Data Type&lt;/th&gt;
          &lt;th&gt;Interpretation&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;[net]&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Unsigned&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;signed [net]&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Signed, 2&amp;rsquo;s complement&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;reg&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Unsigned&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;signed reg&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Signed, 2&amp;rsquo;s complement&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;integer&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Signed, 2&amp;rsquo;s complement&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;time&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Unsigned&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;real&lt;/code&gt;, &lt;code&gt;realtime&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Signed, floating point&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;我们同样可以结合例子进行辅助说明：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-verilog&#34; data-lang=&#34;verilog&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;integer&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;intA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;regA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;reg&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;signed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;regS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;intA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;regA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;intA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// expression result is -4,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// intA is an integer data type, regA is 65532
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;regA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;intA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;regA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// regA is 65524
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// expression result is 21841,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// regA is a reg data type
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;intA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;&amp;#39;d12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// expression result is 1431655761.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// -4&amp;#39;d12 is effectively a 32-bit reg data type
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;regA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// expression result is -4, -12 is effectively
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// an integer data type. regA is 65532
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;regS&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// expression result is -4. regS is a signed reg
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;regS&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sd12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// expression result is 1. -4&amp;#39;sd12 is actually 4.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;// The rules for integer division yield 4/3==1.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这里需要进行一些补充说明，以第一个例子为例，首先在&lt;code&gt;intA = -4&#39;d12;&lt;/code&gt;中，&lt;code&gt;-4&#39;d12&lt;/code&gt;为一个整型数，不涉及表达式运算，因此将其直接赋值给&lt;code&gt;intA&lt;/code&gt;后，&lt;code&gt;intA&lt;/code&gt;将其推断为有符号数&lt;code&gt;-12&lt;/code&gt;。而在&lt;code&gt;regA = intA / 3;&lt;/code&gt;中，&lt;code&gt;intA&lt;/code&gt;为有符号数&lt;code&gt;-12&lt;/code&gt;，因此其除以&lt;code&gt;3&lt;/code&gt;的结果是&lt;code&gt;-4&lt;/code&gt;（这里&lt;code&gt;3&lt;/code&gt;也是一个整型数，在表达式中参与运算，没有基数标识符，被推断为有符号数），而赋值给&lt;code&gt;regA&lt;/code&gt;后，由于&lt;code&gt;regA&lt;/code&gt;没有被声明为&lt;code&gt;signed reg&lt;/code&gt;，因此&lt;code&gt;-4&lt;/code&gt;被推断为无符号数，亦即&lt;code&gt;16&#39;hfffb=65532&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;再看最后一个例子，&lt;code&gt;-4&#39;sd12&lt;/code&gt;也是一个整型数，且参与表达式运算，由于其存在基数标识符，且被指定为有符号数，因此在参与表达式运算时被推断为有符号数&lt;code&gt;4&lt;/code&gt;（有符号数&lt;code&gt;-12&lt;/code&gt;截位得到），进而表达式的值为&lt;code&gt;1&lt;/code&gt;，而由于&lt;code&gt;regS&lt;/code&gt;被声明为&lt;code&gt;signed reg&lt;/code&gt;，因此&lt;code&gt;1&lt;/code&gt;被推断为有符号数，二进制表示为&lt;code&gt;16&#39;h0001&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id=&#34;比较运算符&#34;&gt;比较运算符
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;[5.1.7] When one or both operands of a relational expression are unsigned, the expression shall be interpreted as a comparison between unsigned values. If the operands are of unequal bit lengths, the smaller operand shall be zero-extended to the size of the larger operand.&lt;/p&gt;
&lt;p&gt;When both operands are signed, the expression shall be interpreted as a comparison between signed values. If the operands are of unequal bit lengths, the smaller operand shall be sign-extended to the size of the larger operand.&lt;/p&gt;
&lt;p&gt;If either operand is a real operand, then the other operand shall be converted to an equivalent real value and the expression shall be interpreted as a comparison between real values.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里给出在进行比较运算（包括大于/小于/等于/不等于等运算）时，运算符两侧的运算数的推断规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;只要比较运算符两侧的操作数&lt;strong&gt;有一个为无符号数&lt;/strong&gt;，则比较运算被推断为&lt;strong&gt;无符号数&lt;/strong&gt;间的比较，如果操作数位宽不匹配，则位宽较小者需要通过&lt;strong&gt;0位扩展&lt;/strong&gt;使其与位宽较大者匹配。&lt;/li&gt;
&lt;li&gt;只有比较运算符两侧的操作数&lt;strong&gt;均为有符号数&lt;/strong&gt;，比较运算才被推断为&lt;strong&gt;有符号数&lt;/strong&gt;间的比较，如果操作数位宽不匹配，则位宽较小者需要通过&lt;strong&gt;符号位扩展&lt;/strong&gt;使其与位宽较大者匹配。&lt;/li&gt;
&lt;li&gt;只要比较运算符两侧的操作数&lt;strong&gt;有一个为实数型（&lt;code&gt;real&lt;/code&gt;）&lt;/strong&gt;，则比较运算被推断为&lt;strong&gt;实数&lt;/strong&gt;间的比较，其余非实数操作数被转换为等价的实数。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;移位运算符&#34;&gt;移位运算符
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;[5.1.12] The logical right shift shall fill the vacated bit positions with zeroes. The arithmetic right shift shall fill the vacated bit positions with zeroes if the result type is unsigned. It shall fill the vacated bit positions with the value of the most significant (i.e., sign) bit of the left operand if the result type is signed. If the right operand has an x or z value, then the result shall be unknown. The right operand is always treated as an unsigned number and has no effect on the signedness of the result.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里给出在进行移位运算时，运算结果的推断规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;运算符的右操作数始终被推断为&lt;strong&gt;无符号数&lt;/strong&gt;，且对运算结果无影响。&lt;/li&gt;
&lt;li&gt;当使用&lt;strong&gt;逻辑右移（&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;）&lt;strong&gt;时，运算结果的空位需要进行&lt;/strong&gt;0位扩展&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;当使用&lt;strong&gt;算数右移（&lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;）&lt;strong&gt;时，如结果类型是&lt;/strong&gt;有符号数&lt;/strong&gt;，则空位需要进行&lt;strong&gt;符号位扩展&lt;/strong&gt;；如结果类型是&lt;strong&gt;无符号数&lt;/strong&gt;，则空位需要进行&lt;strong&gt;0位扩展&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;表达式的符号推断规则&#34;&gt;表达式的符号推断规则
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;[5.5.1] The following are the rules for determining the resulting type of an expression:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Expression type depends only on the operands. It does not depend on the left-hand side (if any).&lt;/li&gt;
&lt;li&gt;Decimal numbers are signed.&lt;/li&gt;
&lt;li&gt;Based_numbers are unsigned, except where the s notation is used in the base specifier (as in&amp;quot;&lt;code&gt;4&#39;sd12&lt;/code&gt;&amp;quot;).&lt;/li&gt;
&lt;li&gt;Bit-select results are unsigned, regardless of the operands.&lt;/li&gt;
&lt;li&gt;Part-select results are unsigned, regardless of the operands even if the part-select specifies the entire vector.&lt;/li&gt;
&lt;li&gt;Concatenate results are unsigned, regardless of the operands.&lt;/li&gt;
&lt;li&gt;Comparison results (1, 0) are unsigned, regardless of the operands.&lt;/li&gt;
&lt;li&gt;Reals converted to integers by type coercion are signed&lt;/li&gt;
&lt;li&gt;The sign and size of any self-determined operand are determined by the operand itself and independent of the                            remainder of the expression.&lt;/li&gt;
&lt;li&gt;For nonself-determined operands, the following rules apply:
&lt;ul&gt;
&lt;li&gt;If any operand is real, the result is real.&lt;/li&gt;
&lt;li&gt;If any operand is unsigned, the result is unsigned, regardless of the operator.&lt;/li&gt;
&lt;li&gt;If all operands are signed, the result will be signed, regardless of operator, except when specified otherwise.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;在前几节中，我们分别讨论了整型数常量，变量与特定运算符运算时的符号推断规则。综合来看，上述规则本质上约束的对象是&lt;strong&gt;操作数&lt;/strong&gt;（比如比较运算符中，我们实际上是在根据比较运算符两侧的操作数类型推断在进行比较时，操作数本身应该视为有符号数还是无符号数），而在本节中，我们主要聚焦于对于一个一般的表达式而言，其&lt;strong&gt;运算结果&lt;/strong&gt;的符号类型推断。标准中给出了如下的规则：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;表达式的符号类型只与&lt;strong&gt;操作数&lt;/strong&gt;有关，与 &lt;strong&gt;表达式赋值的对象（LHS）&lt;/strong&gt; 无关。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;十进制数&lt;/strong&gt;被推断为&lt;strong&gt;有符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;含基数标识符的操作数&lt;/strong&gt;被推断为&lt;strong&gt;无符号数&lt;/strong&gt;，除非使用&lt;code&gt;s&lt;/code&gt;指定其为有符号数（如&lt;code&gt;4&#39;sd12&lt;/code&gt;）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;比特选择后的结果&lt;/strong&gt;被推断为&lt;strong&gt;无符号数&lt;/strong&gt;（如&lt;code&gt;a[1]&lt;/code&gt;）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;部分选择后的结果&lt;/strong&gt;被推断为&lt;strong&gt;无符号数&lt;/strong&gt;（如&lt;code&gt;b[4:2]&lt;/code&gt;）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;拼接运算后的结果&lt;/strong&gt;被推断为&lt;strong&gt;无符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;比较运算的结果&lt;/strong&gt;被推断为&lt;strong&gt;无符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;实数强制转换为整型数的结果&lt;/strong&gt;被推断为&lt;strong&gt;有符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;对于&lt;strong&gt;自决操作数（self-determined operand）&lt;/strong&gt;，其符号类型只与操作数本身有关，与表达式其余部分独立。&lt;/li&gt;
&lt;li&gt;对于&lt;strong&gt;非自决操作数&lt;/strong&gt;，其符号推断遵循如下规则：
&lt;ul&gt;
&lt;li&gt;如果操作数中有一者为&lt;strong&gt;实数&lt;/strong&gt;，则运算结果被推断为&lt;strong&gt;实数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;如果操作数中有一者为&lt;strong&gt;无符号数&lt;/strong&gt;，则运算结果被推断为&lt;strong&gt;无符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;如果所有操作数均为&lt;strong&gt;有符号数&lt;/strong&gt;，则运算结果被推断为&lt;strong&gt;有符号数&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;对于上述规则，我们需要说明以下几点：&lt;/p&gt;
&lt;p&gt;首先，需要注意&lt;strong&gt;操作数&lt;/strong&gt;与&lt;strong&gt;表达式&lt;/strong&gt;是一个相对的概念，一个表达式可以作为一个更为复杂表达式中的操作数，比如&lt;code&gt;(1 + 2) * (3 % 4)&lt;/code&gt;，我们也可以将&lt;code&gt;(1 + 2)&lt;/code&gt;与&lt;code&gt;(3 % 4)&lt;/code&gt;视为乘法运算的两个操作数。&lt;/p&gt;
&lt;p&gt;其次，第9条规则引入了&lt;strong&gt;自决操作数&lt;/strong&gt;的概念，将其定义为符号类型只与操作数本身有关的操作数，这里其实只是对于这类操作数进行了形式上的定义，并没有引入新的推断规则。但是第10条规则引入了对&lt;strong&gt;非自决操作数&lt;/strong&gt;的推断规则，因此有必要明确自决操作数究竟指什么：根据定义，自决操作数其实就是指本身就可以判定符号的操作数，比如之前的整型数&lt;code&gt;-&#39;sd12&lt;/code&gt;，或是第2-8条规则中规定的运算结果（比特选择，拼接运算，比较运算等）。这其实就意味着&lt;strong&gt;Verilog中的这些操作数的符号类型是明确的，不会因为表达式上下文而改变&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;但是，诸如&lt;code&gt;reg regA&lt;/code&gt;，&lt;code&gt;wire wireA&lt;/code&gt;这类变量，它们其实只有默认的符号推断，而它们在表达式中实际的符号推断是可变的，需要结合表达式本身确定，这也就是&lt;strong&gt;非自决操作数&lt;/strong&gt;的概念，第10条规则规定了对非自决操作数的符号推断。&lt;/p&gt;
&lt;p&gt;但是，我们仔细阅读第10条规则，会发现一个问题，这里其实说明的是如何推断运算结果的符号类型，但是对于非自决操作数本身，这一条规则并没有说明其在参与运算时应如何进行符号推断，这一点其实在标准的5.5.2节中才提到：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[5.5.2] The following are the steps for evaluating an expression:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Determine the expression size based upon the standard rules of expression size determination.&lt;/li&gt;
&lt;li&gt;Determine the sign of the expression using the rules outlined in 5.5.1.&lt;/li&gt;
&lt;li&gt;Propagate the type and size of the expression (or self-determined subexpression) back down to the context-determined operands of the expression. In general, any context-determined operand of an operator shall be the same type and size as the result of the operator. However, there are two exceptions:
&lt;ul&gt;
&lt;li&gt;If the result type of the operator is real and if it has a context-determined operand that is not real, that operand shall be treated as if it were self-determined and then converted to real just before the operator is applied.&lt;/li&gt;
&lt;li&gt;The relational and equality operators have operands that are neither fully self-determined nor fully context-determined. The operands shall affect each other as if they were context-determined operands with a result type and size (maximum of the two operand sizes) determined from them. However, the actual result type shall always be 1 bit unsigned. The type and size of the operand shall be independent of the rest of the expression and vice versa.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When propagation reaches a simple operand as defined in 5.2 (a primary as defined in A.8.4), then that operand shall be converted to the propagated type and size. If the operand must be extended, then it shall be sign-extended only if the propagated type is signed.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;在这一部分其实说明了，对于&lt;strong&gt;非自决操作数&lt;/strong&gt;，也就是标准中提及的&lt;strong&gt;上下文决定操作数（context-determined operand）&lt;strong&gt;其符号是通过&lt;/strong&gt;表达式结果的符号类型向下传播&lt;/strong&gt;确定的。但这里同样有两个例外：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果表达式结果是&lt;strong&gt;实数&lt;/strong&gt;，则对于&lt;strong&gt;非实数&lt;/strong&gt;的上下文决定操作数，需要先假定其为&lt;strong&gt;自决操作数&lt;/strong&gt;，据此判断其取值，再将该值转换为实数。举一个例子，假设我们声明了一个变量&lt;code&gt;reg [3:0] a = 4&#39;b1111；&lt;/code&gt;，则对表达式&lt;code&gt;a * 1.5&lt;/code&gt;而言，由于有实数&lt;code&gt;1.5&lt;/code&gt;的存在，表达式结果被推断为实数，且&lt;code&gt;a&lt;/code&gt;是一个非实数的非自决操作数。因此，我们需要先假定&lt;code&gt;a&lt;/code&gt;为自决操作数，此时就直接使用&lt;code&gt;a&lt;/code&gt;的默认符号推断，即无符号数，进而&lt;code&gt;a&lt;/code&gt;的值就是&lt;code&gt;15&lt;/code&gt;，再将其转换为实数&lt;code&gt;15.0&lt;/code&gt;参与运算。&lt;/li&gt;
&lt;li&gt;对于&lt;strong&gt;比较运算符&lt;/strong&gt;，它的两个操作数不是严格的自决操作数或非自决操作数，因为两个操作数的符号推断是相互确定的，具体规则已在上文提及，此处不再赘述。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;综上：&lt;strong&gt;表达式结果的符号本身是由所有操作数共同决定的规则推导出来的&lt;/strong&gt;，它是一个&lt;strong&gt;自底向上&lt;/strong&gt; + &lt;strong&gt;自顶向下&lt;/strong&gt;结合的过程：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;首先，根据自决操作数符号类型，确定表达式结果的符号类型。&lt;/li&gt;
&lt;li&gt;然后，再将表达式结果的符号类型应用到所有非自决操作数上，并进行运算。&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
    </channel>
</rss>
